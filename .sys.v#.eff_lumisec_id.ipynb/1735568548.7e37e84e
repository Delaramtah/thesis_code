{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "dcc84c01",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "eff [0.8741509258397693, 0.8829273375850349, 0.887218754378477]\n",
      "efferr [0.013812011220850386, 0.01330370713885666, 0.015172087095879003]\n"
     ]
    },
    {
     "data": {
      "image/png": "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aKE/f/58koz6mT9//sQ0eCO1PhtPBr8kaaMzf/58qurxz4EHHsiBBx64RllVrXfwT5kyhX333ffxz0knnQTA9773Pfbcc0/23XdfHnzwQd7//vez55578v73v59TTjmFs88+e8R5Ll++nDe+8Y3r1Z6J5Dl+SdJGbeHChfzgBz9g5cqVzJw5kwULFjB37twnNc8tttiCxYsXD7us973vfRx11FEAnHrqqfziF7/g6U9/+qjz3H777fnKV77ypNo1EdzjlyRttBYuXMi8efNYuXIlALfccgvz5s1j4cKF476sz33uc5x33nl89KMfZe7cubzuda/jN7/5Dfvvvz/nnnsu8+fP5+STTwZgyZIlvPzlL2efffbhhS98IT//+c9ZunQpe+21FwCPPvoo73//+9lvv/3Ye++9OfXUU4Enni74xje+kd122425c+fSu7sdFi1axEte8hL22WcfZs+ezf33388f/uEfrrGBcsABB3DllVc+qfV0j1+StNE64YQTeOCBB9Yoe+CBBzjhhBOe1F7/gw8+yL777vv48Ic+9CGOOeYYLrvsMl7zmtc8fsh+2rRpjwdv/2mFuXPncvzxx3PYYYfx0EMP8dhjj3HXXU88Rf6MM85g6623ZtGiRaxcuZIDDjiAV77ylQD89Kc/5ZprrmH77bfngAMO4N///d+ZPXs2b3rTmzj33HPZb7/9uO+++9hiiy045phj+MIXvsDf/d3f8bOf/YyVK1ey9957r/d6g8EvSdqI3XrrretUPlYjHeofi/vvv5/bb7+dww47DOjdSz/o29/+NldeeeXjh/5//etfc+ONN7LZZpsxe/ZsZsyYAcC+++7L0qVL2Xrrrdluu+3Yb7/9ANhqq60AOPzwwznxxBP527/9W84880z+5E/+ZL3a3M/glyRttHbaaSduueW33zez0047bYDW9Kw+ND/aOP/wD//AwQcfvEb50NDQGtcLTJkyhVWrVlFVw16hP3XqVF7xilfwta99jfPOO4+RXji3LjzHL0naaC1YsICpU6euUTZ16lQWLFiwgVrU2xufMWMGX/3qVwFYuXLlb52OOPjgg/nsZz/LI488AsDPfvYzfvOb34w4z912243ly5ezaNEioHdUYdWqVQAcc8wx/Nmf/Rn77bcfz3zmM590+93jlyRttFafxz/66KNZuXIlO++887hc1T94jv+Q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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 14091.75  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 4057.50    # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 12582.39  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 3336.75  # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 9593.35  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 2438.97  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 210.84 # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 163.75 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 181.22 # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 126.18 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 150.83 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 145.46 # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "print(\"eff\",efficiencies)\n",
    "print(\"efferr\",efficiency_errors)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints, efficiencies, yerr=efficiency_errors, fmt='o', color='black', label='Efficiency', capsize=5)\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"Efficiency\")\n",
    "plt.title(\"Efficiencies vs Lumisec for EE_ID\")\n",
    "plt.ylim([0.8,1.0])\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "3265443c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "eff [0.8876356863954444, 0.8921138159793809, 0.9003876019847467]\n",
      "efferr [0.01110590077325191, 0.011473568983634296, 0.011676416537930213]\n"
     ]
    },
    {
     "data": {
      "image/png": "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XYdezuseJEmT6sEHH2S77bZbr6HfR0nYbrvt1nrkxOCXJE26iUJ/4UJIJn4tXDgpzd1orcuXJ4NfkrTRWbgQqh5/vfSlzWuwrGrdg3/atGnMnj37sdcJJ5wAwDe+8Q2e//znM3v2bB544AHe//738/znP5/3v//9nHrqqZxzzjnjrnP58uW86U1vWrcGTSKP8UuSNmrnngvf+hY89BDssgscfzzMn//E1rnFFluwePHiMbZ1Ln/0R3/EEUccAcBpp53GT37yE5761KdOuM4ddtiBz33uc0+sYZPAPX5J0kbr3HNhwYIm9AF+/ONm+txz1/+2PvnJT3LBBRfw4Q9/mPnz5/P617+e++67j/3224/zzz+fhQsXcuKJJwKwZMkSXvGKV7DXXnvxwhe+kB/96EcsXbqUF7ygeSbdI488wvvf/3723Xdf9txzT0477TTg8bsLvulNb2L33Xdn/vz5rHpY3qJFi3jJS17CXnvtxdy5c7n33nv5nd/5ndW+oOy///5cc801T+hzuscvSdpo/cmfwP33r152//1N+RPZ63/ggQeYPXv2Y9Mf/OAHOeqoo7jiiit47Wtf+9iQ/fTp0x8L3oUDxxXmz5/PscceyyGHHMKDDz7Io48+yl13PX4X+TPPPJOtt96aRYsW8dBDD7H//vvzqle9CoDvfe97XHfddeywww7sv//+/Pu//ztz587lLW95C+effz777rsv99xzD1tssQVHHXUUZ599Nh/96Ef54Q9/yEMPPcSee+657h8cg1+StBG79da1Kx/WeEP9w7j33nu5/fbbOeSQQ4DmWvrRvvrVr3LNNdc8NvT/y1/+kptuuonNNtuMuXPnMmvWLABmz57N0qVL2Xrrrdl+++3Zd999Adhqq60AePOb38xxxx3H3/zN33DWWWfx9re/fZ3aPMjglyRttJ797GZ4f6zyDWXV0PxE8/zd3/0dBx544GrlIyMjq50vMG3aNFauXElVjXmG/pZbbskrX/lKvvCFL3DBBRcw3gPn1obH+CVJG63jj4ctt1y9bMstm/INZauttmLWrFl8/vOfB+Chhx7i/lHHIw488EA+8YlP8PDDDwPwwx/+kPvuu2/cde6+++4sX76cRYsWAc2owsqVKwE46qij+P3f/3323Xdfnv70pz/h9rvHL0naaK06jn/kkc0JfjvvvH7O6h99jP+ggw56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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 =  14291.01  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 =  3618.15   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 =  12161.30 # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =   2941.41  # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  9950.44  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 2201.69   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 172.36 # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 107.20 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 151.05  # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 90.99 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 124.72 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 73.54  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "print(\"eff\",efficiencies)\n",
    "print(\"efferr\",efficiency_errors)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints, efficiencies, yerr=efficiency_errors, fmt='o', color='blue', label='Efficiency', capsize=5)\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"Efficiency\")\n",
    "plt.title(\"Efficiencies vs Lumisec for BE_ID\")\n",
    "plt.ylim([0.8,1.0])\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "7158ac00",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "eff [0.9221176388096228, 0.9198121017168198, 0.897629180271136]\n",
      "efferr [0.00970416165075928, 0.011424856492482137, 0.012553128527146252]\n"
     ]
    },
    {
     "data": {
      "image/png": "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NltvvXXf8xj8kqShWrlyJTNnzmTPPfckGetGrs1zzz33MHPmzElb3pauqrj77rtZuXIle+21V9/zed+DJGmoHnjgAZ761KdOauh3URKe+tSnbvKRE4NfkjR0E4b+okWQTPxatGgY3d1ibc6XJ4NfkrTlWbQIqh59veQlzau3rGqzg3/atGnMmTPnkdcpp5wCwLe+9S2e+9znMmfOHO6//37e97738dznPpf3ve99nHbaaXzuc58bd5mrVq3iDW94w2b1Z5g8xy9J2rItWQLf+Q6sXQt77gknnwwLHtvvFG2//fYsW7ZsjFUt4Y//+I859thjATj99NP5yU9+wrbbbjvhMnfddVe++MUvPqZ+DYN7/JKkLdeSJbBwYRP6ALfc0kwvWTLpq/r0pz/Neeedx4c//GEWLFjAa1/7Wu69914OOuggzj33XBYtWsSpp54KwPLly3n5y1/OAQccwPOf/3x+/OMfs2LFCvbbbz8AHnroId73vvdx4IEHsv/++3P66acDjz5d8A1veAP77LMPCxYsoLm7HZYuXcqLX/xiDjjgAObNm8c999zD7/zO72zwBeXggw/mqquuekzb6R6/JGnL9aEPwX33bVh2331N+WPY67///vuZM2fOI9Mf+MAHOO6447jssst49atf/cgh+xkzZjwSvIt6TissWLCAE088kSOPPJIHHniAhx9+mLvuevQp8meeeSY77rgjS5cuZe3atRx88MG84hWvAOAHP/gB11xzDbvuuisHH3ww//Zv/8a8efN405vexLnnnsuBBx7I6tWr2X777TnuuOM4++yz+eu//mt+9KMfsXbtWvbff//N3m4w+CVJW7Jbb9208j6Nd6i/H/fccw+33347Rx55JNDcSz/a17/+da666qpHDv3/8pe/5MYbb2SbbbZh3rx5zJ49G4A5c+awYsUKdtxxR3bZZRcOPPBAAHbYYQcA3vjGN3LSSSfxV3/1V5x11lm89a1v3aw+9zL4JUlbrmc+szm8P1b542T9ofmJ2vzt3/4thx122AblIyMjG1wvMG3aNNatW0dVjXmF/vTp0zn00EP58pe/zHnnncd4Pzi3KTzHL0nacp18MkyfvmHZ9OlN+eNkhx12YPbs2XzpS18CYO3atdw36nTEYYcdxqc+9SkefPBBAH70ox9x7733jrvMffbZh1WrVrF06VKgOaqwbt06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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 =  16044.1  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 =  2710.18   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 =  12305.72  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  2145.59   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  7547.89   # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 1721.61  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 160.58 # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 113.17 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 149.02  # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 73.91  # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 100.16 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 74.23  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "print(\"eff\",efficiencies)\n",
    "print(\"efferr\",efficiency_errors)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints, efficiencies, yerr=efficiency_errors, fmt='o', color='red', label='Efficiency', capsize=5)\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"Efficiency\")\n",
    "plt.title(\"Efficiencies vs Lumisec for BB_ID\")\n",
    "plt.ylim([0.8,1.0])\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "b87fc8c2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "eff [0.8741509258397693, 0.8829273375850349, 0.887218754378477]\n",
      "efferr [0.013812011220850386, 0.01330370713885666, 0.015172087095879003]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE.root\"\n",
    "c_h = 0.9998\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 14091.75  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 4057.50    # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 12582.39  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 3336.75  # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 9593.35  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 2438.97  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 210.84 # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 163.75 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 181.22 # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 126.18 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 150.83 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 145.46 # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "efficiencyc_bin1 = 1/c_h*((2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1))\n",
    "efficiencyc_bin2 = 1/c_h*((2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2))\n",
    "efficiencyc_bin3 = 1/c_h*((2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3))\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "efficienciesc = [efficiencyc_bin1, efficiencyc_bin2, efficiencyc_bin3]\n",
    "efficiencyc_errors = [1/c_h*efficiency_error_bin1, 1/c_h*efficiency_error_bin2, 1/c_h*efficiency_error_bin3]\n",
    "\n",
    "print(\"eff\",efficiencies)\n",
    "print(\"efferr\",efficiency_errors)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints, efficiencies, yerr=efficiency_errors, fmt='o', color='black', label='Efficiency', capsize=10 ,capthick=10, ecolor='blue')\n",
    "plt.errorbar(lumisec_midpoints, efficienciesc,yerr=efficiencyc_errors, fmt='o', color='green', label='Efficiency (C)', capsize=5,capthick=1, ecolor='red')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"Efficiency\")\n",
    "plt.title(\"Efficiencies vs Lumisec for EE_ID\")\n",
    "plt.ylim([0.8,1.0])\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e7823a6",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
