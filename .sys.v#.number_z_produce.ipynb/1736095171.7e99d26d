{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "aded88e4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14036.20919795857, 12603.03564771506, 9767.858736758113]\n",
      "lumi [40452.554757358, 36151.21170168409, 27566.953653143104]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE_hlt.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 10392.20   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 3370.69    # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 9293.67   # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 3057.84   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 7196.86   # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 2375.05   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 = 159.01  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 98.26   # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 142.85  # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 90.42   # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 121.28  # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 71.29   # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints,N_values , marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_HLT vs Lumisec_EE\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "9dc95429",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14551.045985363908, 12733.332086577184, 10091.750918470183]\n",
      "lumi [31544.959148721486, 27604.368847586757, 21877.731043006734]\n"
     ]
    },
    {
     "data": {
      "image/png": "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sGDBa59KeO655zJr1iw+8IEP0NXVxfXXX8/nPvc5Jk+ezPTp01mzZg0A3d3dLFiwgHXr1nHiiScyadIkJk+e/Nrz+NWvfsX06dOZOnUqhx56KL/85S8BeOaZZzj66KOZMmUKU6ZM4Y477hhKu5oyBGyG+fNh9mx4/HHIrH7Onm0QkKRmWvmaeeqppzJ//nxefvnlpuuHDRvGkUceyfe//30A7r77brq6uhg/fjznnXceP/nJT1i4cCE33njjlk+G6hf4TTfdxA033MDxxx/P+973PhYtWsROO+3ETTfdtMG2999/P08++SQPPPAAixYt4mMf+xgAs2fP5utf/zr33nsvF1xwAX/+538OwGmnncbv/d7vsXDhQu677z4OPPDALZ6vIWAznH02rFq1YW3VqqouSdpQK18zR48ezQknnMBFF1004DbHHXccV199NQBXXXUVxx13HADvfe97OfHEE/nmN7/JunXrtnwywB/+4R+yww47MHnyZNatW8f06dMBmDx5Mo899tgG2771rW/lkUce4dOf/jQ//vGPGT16NCtXruSOO+7g2GOP5aCDDuITn/gETz/9NAC33norp5xyCgDDhw9nzJgxWzxfQ8BmeOKJodUlqWStfs38zGc+w7x583jllVearn/Pe97DkiVLeO655/jBD37Ahz/8YQC+8Y1v8MUvfpGlS5dy0EEHsWzZsk16vBEjRrB+/XqA170lb8cddwSqIxA77LDDa1fsDxs2jLVr126w7e67787ChQvp7u7mn/7pnzj55JNZv349u+22G/fff/9rt1Z+4JEhYDPss8/Q6pJUsla/Zu6xxx78yZ/8CfPmzWu6PiI4+uijOeOMM3j729/O2LFjgerQ/bvf/W7OO+88xo0bx9KlSzfp8bq6urj33nsB+N73vrfZ837++edZv349H/nIRzj//PO57777GD16NBMnTuTaa68Fqg8BWrhwIQCHH344l1xyCQDr1q1j+fLlm/3YfQwBm2HOHBg1asPaqFFVXZK0oXa8Zp555pkbfZfAcccdxxVXXPHaqQCAz372s0yePJlJkyZx2GGHMWXKlNeNe/jhh5kwYcJrt2uvvZZzzjmH008/nUMPPZThw4dv9pyffPJJuru7OeiggzjxxBP50pe+BMD8+fOZN28eU6ZM4cADD+SGG24A4Gtf+xq33XYbkydPZurUqTz4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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 =  10692.75 # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 =  3561.70  # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 =  9275.25  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  3184.71   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  7337.99  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  2534.85   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 149.67# Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 84.11 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 133.06 # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 72.53 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 116.85 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 63.34 # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_HLT vs Lumisec_BE\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "51c6e925",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [11684.14212370706, 10194.79585686655, 7801.4145289387825]\n"
     ]
    },
    {
     "data": {
      "image/png": "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+cM//EOGhoa44oor+Ou//msWLlzIkiVLeO655wAYHh5m9erVbNy4kVNOOYUFCxawcOHC51/Hz3/+c5YsWcKiRYs46qij+Nd//VcAHnzwQY477jgOO+wwDjvsMH74wx9OpV0TMgRsg1WrYPlyuOceqOrcL19uEJCkifTyZ+Zpp53GqlWrePzxxycc32233Vi6dCnf/OY3AbjhhhsYGhpizpw5nHnmmfzTP/0Tt9xyC1ddddVLnwydX+BXX301V155Je985zv5gz/4A2699Vb23HNPrr766hese/PNN3P//fezZs0abr31Vv70T/8UgOXLl/P5z3+eG2+8kbPOOou/+Iu/AOCDH/wgv//7v88tt9zCTTfdxKGHHvqS52sI2Aaf+AQ8/fQLa08/3alLkl6olz8zZ82axUknncQ555wz6TonnHAC3/jGNwC4+OKLOeGEEwB44xvfyCmnnMKXvvQlNm7c+NInA/zRH/0Ru+++OwsXLmTjxo0sWbIEgIULF3L33Xe/YN1Xv/rV/OIXv+ADH/gA3/nOd5g1axbr16/nhz/8IccffzyHH344733ve1m3bh0A1113HaeeeioA06ZNY++9937J8zUEbIN7751aXZLarNc/Mz/84Q9z3nnn8dRTT004/oY3vIG1a9fy8MMP861vfYu3vvWtAHzxi1/k05/+NPfddx+HH344jz766FY93/Tp09m0aRPAiz6St8ceewCdIxC7777781fs77bbbmzYsOEF6+6zzz7ccsstDA8P8/d///e85z3vYdOmTbziFa/g5ptvfv7Wyy88MgRsgwMPnFpdktqs1z8z9913X/7kT/6E8847b8LxJBx33HF85CMf4bWvfS2zZ88GOofuf/d3f5czzzyT/fbbj/vuu2+rnm9oaIgbb7wRgMsvv3yb5/3II4+wadMm3va2t/GpT32Km266iVmzZjF//nwuvfRSoPMlQLfccgsAxxxzDOeeey4AGzdu5Iknntjm5x5jCNgGK1bAzJkvrM2c2alLkl6oHz8zTz/99M1+SuCEE07gwgsvfP5UAMBHP/pRFi5cyIIFCzj66KM57LDDXrTdnXfeybx5856/XXrppZxxxhl86EMf4qijjmLatGnbPOf777+f4eFhDj/8cE455RT+5m/+BoBVq1Zx3nnncdhhh3HooYdy5ZVXAvC5z32O733veyxcuJBF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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_ vs Lumisec_BB\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "99e935c7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [18441.330842994266, 16140.353268559671, 12187.337491223963]\n",
      "lumi [52315.55170786302, 45028.946744688306, 33276.63087550684]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = float(open(\"N_2Iee1.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = float(open(\"N_1Iee1.txt\").read())   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = float(open(\"N_2Iee2.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = float(open(\"N_1Iee2.txt\").read())    # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = float(open(\"N_2Iee3.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = float(open(\"N_1Iee3.txt\").read())  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 =  float(open(\"eN_2Iee1.txt\").read())  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 =  float(open(\"eN_1Iee1.txt\").read())  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 =  float(open(\"eN_2Iee2.txt\").read()) # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 =  float(open(\"eN_1Iee2.txt\").read())  # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 =  float(open(\"eN_2Iee3.txt\").read()) # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 =  float(open(\"eN_1Iee3.txt\").read()) # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints,N_values , marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_ID vs Lumisec_EE\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c3749b06",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14118.654770683628, 11370.420889094221, 9367.676159912931]\n",
      "lumi [39231.209652052145, 30526.777599325418, 25281.110636684116]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = float(open(\"N_2Ibb9.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = float(open(\"N_1Ibb9.txt\").read())   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = float(open(\"N_2Ibb10.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = float(open(\"N_1Ibb10.txt\").read())    # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = float(open(\"N_2Ibb11.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = float(open(\"N_1Ibb11.txt\").read())  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 =  float(open(\"eN_2Ibb9.txt\").read())  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 =  float(open(\"eN_1Ibb9.txt\").read())  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 =  float(open(\"eN_2Ibb10.txt\").read()) # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 =  float(open(\"eN_1Ibb10.txt\").read())  # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 =  float(open(\"eN_2Ibb11.txt\").read()) # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 =  float(open(\"eN_1Ibb11.txt\").read()) # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints,N_values , marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_ID vs Lumisec_BB\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "983f8c52",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [18138.173044660616, 15280.569652944374, 12273.9271003187]\n",
      "lumi [50673.8346114177, 42191.30539191176, 33022.90884598454]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = float(open(\"N_2Ibe4.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = float(open(\"N_1Ibe4.txt\").read())   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = float(open(\"N_2Ibe5.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = float(open(\"N_1Ibe5.txt\").read())    # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = float(open(\"N_2Ibe6.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = float(open(\"N_1Ibe6.txt\").read())  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 =  float(open(\"eN_2Ibe4.txt\").read())  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 =  float(open(\"eN_1Ibe4.txt\").read())  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 =  float(open(\"eN_2Ibe5.txt\").read()) # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 =  float(open(\"eN_1Ibe5.txt\").read())  # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 =  float(open(\"eN_2Ibe6.txt\").read()) # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 =  float(open(\"eN_1Ibe6.txt\").read()) # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints,N_values , marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_ID vs Lumisec_BE\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9f057fe1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "lumi_bril [116086.333, 100081.51, 93398.989]\n",
      "lumi_EE [43812.13332817731, 39029.39405516948, 30115.508265133147]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAfIAAAFzCAYAAADFfYutAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/H5lhTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAe/ElEQVR4nO3dfZiddX3n8fc3EJiEGUCDTpEkJFouCAUEnVpcdDsRLdEGtda61hSKdq8UCz7XssJq13bZi25Ra20tm0sU3Z1KkYetsoIPyECxPCzBCISoSwsJI1jLU5khJCTw3T/OncnJMJM5J5n7DL+Z9+u65ppzfvfvvs93voH5zP1w7hOZiSRJKtOc6S5AkiTtOYNckqSCGeSSJBXMIJckqWAGuSRJBTPIJUkq2L7TXcCeOOSQQ3LJkiXjLnvyySc54IADOlvQLGfPp4d97zx73nn2fKe1a9c+nJkvGjteZJAvWbKE22+/fdxlg4OD9Pf3d7agWc6eTw/73nn2vPPs+U4RsXG8cQ+tS5JUMINckqSCGeSSJBWsyHPk49m2bRtDQ0McdNBBbNiwYbrLmVU61fOuri4WLlzI3Llza38tSSrFjAnyoaEhenp6WLBgAQceeOB0lzOrDA8P09PTU+trZCaPPPIIQ0NDLF26tNbXkqSSzJhD61u2bGHBggVExHSXohpEBAsWLGDLli3TXYokPa/MmCAHDPEZzn9fSXquGRXkkiTNNrM3yAcGYMkSmDOn8X1gYK832d3dvdfbAHjwwQd5+9vfPuHySy65hLPPPrulbb3pTW/i8ccfB55b34oVK/jpT39Kf3//hDfYaVfz641nn3324fjjjx/9uuCCCwDo7+/nyCOPHB3f3c8vSdppxlzs1paBAVi9GjZvbjzfuLHxHGDVqumrq/KSl7yEyy+/fK+2kZlkJt/85jfHXf7UU0/x6KOPcthhh+3V64w10evtMG/ePNatWzfusoGBAfr6+qa0HknqqIEBOO882LQJFi+G88+vPVdq3SOPiK6IuC0ifhgR6yPik+PMOSoibo6IrRHxh3XWM+q883aG+A6bNzfGp8Dg4CArV64cfX722WdzySWXAI3by5577rm8+tWvpq+vjzvuuINTTjmFl73sZVx00UUA3H///RxzzDG7fY0HHniAFStWcOSRR/LJT35ydL1ly5bxB3/wB7ziFa/ggQceYMmSJTz88MPj1jjebQ+b99ovv/xyzjjjDADOOOMM3vve97J8+XJe+tKXcsMNN/Ce97yHZcuWceaZZ46uM9HrSdKMt2MnceNGyNy5kzgFR3x3p+5D61uB12Xmy4HjgRURceKYOY8C7wcurLmWnTZtam98ii1atIibb76Z1772tZxxxhlcfvnl3HLLLXziE59oeRu33XYbAwMDrFu3jq997Wujh8Z//OMfc/rpp/ODH/yAww8/fML1r7nmGlasWNFW3Y899hjf+973+MxnPsOpp57Khz70IdavX88999wz4V72WE899dQuh9b/7u/+bnTZqlWrRsc/+tGPtlWbJE27mncSJ1LrofXMTGCkejq3+soxc34O/Dwifr3OWnaxeHHjL6XxxjvgzW9+MwDHHnssIyMj9PT00NPTQ1dX127PLzd7wxvewIIFCwB429vexk033cRb3/pWDj/8cE48cezfSs/1/e9/nwsvbO9vp1NPPZWI4Nhjj6W3t5djjz0WgKOOOor777+f448/ftJteGhd0ow1TTuJtZ8jj4h9gLXALwJ/nZm37uF2VgOrAXp7exkcHNxl+UEHHcTw8DDPPPMMw8PDu93Wvh//OF3vex/x1FOjYzlvHls+/nG2T7LuZIaHh3n66ad5+umnR+sYHh5my5YtDA8Pk5ls27ZtdF5EjM6LCB5//HFGRkZ49tlnJ/w5tmzZwvbt20eXb926la1btzIyMsK8efN2WS8zGRkZYf/99x+t5b777uPQQw8dXe+ZZ57hySefZHh4eJd6HnvssdFat23bNlrT5s2bmTt37i51Dw8Pj/58za83UY/Gaq5hd7Zs2fKcf/vZamRkxF50mD3vvJJ6fuKLX0zXv/zLc8a3vPjF3FLjz1B7kGfmM8DxEXEwcFVEHJOZd+/BdtYAawD6+vpy7PndDRs20NPT09pdxn7v96Cra5cLEuL885k3BRck9PT0sGzZMn7yk5+w3377sWXLFm688UaWL19OT08PEUF3d/foHvh+++03Wu+OZQBz5syZ8Ofo6upicHCQbdu2MW/ePK655hq++MUv0t3d/Zz1ml9vR33/8A//wMqVK0fH9tlnHw444AB6enro7e1laGiII488kmuvvXb0aMHcuXOZN28ePT09z3mdiBhdNvb1JurRWM017E5XVxcnnHDCbufMFn68Y+fZ884rquef+tSu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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "import math\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE_hlt.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 10392.20   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 3370.69    # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 9293.67   # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 3057.84   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 7196.86   # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 2375.05   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 = 159.01  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 98.26   # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 142.85  # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 90.42   # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 121.28  # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 71.29   # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.106*4.018*efficiency_bin1*0.8742)\n",
    "l_bin2 = N_bin2/(0.106*4.018*efficiency_bin2*0.8829)\n",
    "l_bin3 = N_bin3/(0.106*4.018*efficiency_bin3*0.8872)\n",
    "lbril_values = [116086.333 , 100081.51 , 93398.989]\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "luminosity_errors = [(0.00264+(4.44*math.pow(10,-6))+0.0235+(4.2162*math.pow(10,-7))) , (0.00247+(4.44*math.pow(10,-6))+0.0235+(5.5358*math.pow(10,-7))) , (0.001366+(4.44*math.pow(10,-6))+0.0235+(9.6669*math.pow(10,-7)))]\n",
    "\n",
    "print(\"lumi_bril\",lbril_values)\n",
    "print(\"lumi_EE\", l_values)\n",
    "rat = [lbril_values[0]/l_values[0], lbril_values[1]/l_values[1] , lbril_values[2]/l_values[2]]\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.errorbar(lumisec_midpoints, l_values, xerr=luminosity_errors, fmt='o', color='black', capsize=5,label=\"lumi_EE\")\n",
    "# plt.errorbar(lumisec_midpoints,lbril_values , xerr=luminosity_errors, fmt='o', color='red', capsize=5,label=\"lumi_bril\")\n",
    "plt.errorbar(lumisec_midpoints, rat , fmt='o', color='red', capsize=5,label=\"lumi_bril/lumi_EE\")\n",
    "\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"lumi_bril/lumi_EE\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "c72ae13d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "lumi_bril [116086.333, 100081.51, 93398.989]\n",
      "lumi_BE [42496.32401611331, 37162.83113517615, 32118.513517910076]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAfkAAAFzCAYAAAA9nXBaAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/H5lhTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAfaklEQVR4nO3de5SddX3v8feXBA1hAsVg00ouA5SlgQABBwon9jSRKrGCouVYNMUi7Uq1pop6eihwLqsXVlmrHFsOraVZIIHT0SwPF4uWixwwUBBvSVMSCKyDQEJMrISgSQhBA9/zx36SbIaZyd7MfvYkv3m/1pq1n/17fs/e3/kF5rOf33PZkZlIkqTyHDDaBUiSpHoY8pIkFcqQlySpUIa8JEmFMuQlSSqUIS9JUqHGj3YBnXT44Ydnb2/vkOtfeOEFDj744O4VJMd8FDjm3eeYd59jvsfy5cs3ZeabB1tXVMj39vby/e9/f8j1y5YtY+7cud0rSI75KHDMu88x7z7HfI+IWDvUOqfrJUkqlCEvSVKhDHlJkgpV1DH5wfz85z9n/fr17Nixg0MPPZQ1a9aMdkljSrfGfMKECUydOpUDDzyw9veSpP1F8SG/fv16Jk2aRG9vL9u2bWPSpEmjXdKYsnXr1trHPDN57rnnWL9+PUceeWSt7yVJ+5Pip+t37NjB5MmTiYjRLkU1iQgmT57Mjh07RrsUSdqnFB/ygAE/BvhvLEmvNSZCXpKksciQH6i/H3p74YADGo/9/SN+yZ6enhG/BsCGDRs499xzh1y/ZMkSFi1a1NJr/eZv/iY/+clPgNfWN3/+fH74wx8yd+7cYW8u1I7m9xvMuHHjmD17NieeeCInn3wy3/rWtwB4+umnOeigg5g9e/bunxtvvLEjNUlS6Yo/8a4t/f2wcCFs3954vnZt4znAggWjV1flLW95CzfddNOIXiMzyUxuv/32Qde/+OKLbN68mSOOOGJE7zPQUO+3y0EHHcTKlSsBuOuuu7jkkku47777ADj66KN3r5Ok/VZ/P1x2GaxbB9Onw+WX154t7sk3u+yyPQG/y/btjfYOWLZsGWedddbu54sWLWLJkiVA45a8l156Kaeffjp9fX2sWLGCM888k6OPPpprrrkGaOzVzpo1a9j3eOaZZ5g/fz5vfetb+dM//dPd282cOZM//MM/5OSTT+aZZ56ht7eXTZs2DVrjYLeKbN7bv+mmm7jgggsAuOCCC/jEJz7BvHnzOOqoo7jvvvu48MILmTlz5u4+u36/wd5vMFu2bOGwww5rqa8k7Rd27USuXQuZe3YiOzBbPBz35JutW9dee4dNmzaNhx56iM985jNccMEFPPjgg+zYsYPjjjuOj3/84y29xne/+11Wr17NxIkTOeWUU3jve9/L4YcfzuOPP87111/PF77whWG3v+OOOzjnnHPaqvv555/n3nvv5bbbbuPss8/mwQcf5Nprr+WUU07h4YcfZs6cOXt9jRdffJHZs2ezY8cONm7cyL333rt73Q9+8ANmz569+/nVV1/Nr/3ar7VVoySNquF2Imvcmzfkm02f3vh0NVh7F7zvfe8D4Pjjj999Tf+kSZOYMGHCsMezm73rXe9i8uTJAHzwgx/kgQce4JxzzmHGjBmcdtppe93+wQcf5Morr2yr7rPPPpuI4Pjjj2fKlCkcf/zxABx33HGsW7eupZBvnq5/6KGH+OhHP8rq1asBp+slFWCUdiKdrm92+eUwceKr2yZObLR3wPjx43nllVd2Px94Xfcb3/hGAA444IDdy7ue79y5s6X3GHgp2a7nrXwl45NPPsm0adN4wxveMOzr1lF3s9NPP51Nmzbx7LPPtr2tJO2ThtpZrHkn0pBvtmABLF4MM2ZARONx8eKOTaXMmDGDRx99lJdeeomf/vSn3HPPPR153WZ33303mzdv5sUXX+SrX/1qS3vRu9xxxx3Mnz9/0HVTpkxhzZo1vPLKK9x6662dKndQjz32GC+//PLuGQlJ2u/VvBM5FKfrB1qwoLbjI9OmTeNDH/oQJ5xwAscccwwnnXRSx9/jHe94B+effz5PPPEEH/nIR+jr6+Ppp59uads777yTq6++etB1V1xxBWeddRbTpk1j1qxZbNu2rYNV7zkmD40rAG644QbGjRsHvPaY/IUXXsinPvWpjr6/JNVqV650+ez6yMxa36Cb+vr6cuB13WvWrGHmzJlAd+6jvr966aWXmDNnTseui9+lm2Pe/G89lg11hYTq45h3n2O+R0Qsz8y+wdY5XS+gcVy90wEvSRpdTtfvh+666y4uvvjiV7UdeeSRtR8rH6nnnnuOM8444zXt99xzj8ffJakGhvx+6Mwzz+TMM88c7TLaNnnyZC+Fk6QuqnW6PiKmRcQ3I2JNRDwSEZ8epM9hEXFrRDwcEd+NiFlN6+ZHxOMR8URE/MnrraOk8w40OP+NJem16j4mvxP4XGbOBE4DPhkRxw7ocymwMjNPAD4KXAUQEeOAvwPeAxwLfHiQbfdqwoQJPPfcc4ZAwTKT5557jgkTJox2KZK0T6l1uj4zNwIbq+WtEbEGOAJ4tKnbscBfVn0ei4jeiJgCHAU8kZlPAkTEUuD9A7bdq6lTp7J+/XqeffZZduzYYRB0WbfGfMKECUydOrX295Gk/UnXjslHRC9wEvCdAav+Dfgg8EBEnArMAKbS+DDwTFO/9cCvDvK6C4GF0Lhhy7Jly4asYdu2bR372le1pptjvnawWxKPQdu2bRv2/wN1nmPefY55a7oS8hHRA9wMXJSZWwasvgK4KiJWAquAf6UxzR+81mvm3DNzMbAYGtfJD3fdpNdVdp9j3n2Oefc55t3nmLem9pCPiANpBHx/Zt4ycH0V+h+r+gbwVPUzEZjW1HUqsKHueiVJKkXdZ9cHcB2wJjM/P0SfX4iIXd+I8vvA/VXwfw84JiKOrNafB9xWZ72SJJWk7j35OcD5wKpqOh4aZ9NPB8jMa4CZwI0R8TKNk+p+r1q3MyIWAXcB44AvZuYjNdcrSVIx6j67/gEGP7be3Och4Jgh1t0O3F5DaZIkFc9710uSVChDXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKpQhL0lSoQx5SZIKZchLklQoQ16SpEIZ8pIkFcqQlySpUIa8JEmFMuQlSSqUIS9JUqEMeUmSCmXIS5JUKENekqRCGfKSJBXKkJckqVCGvCRJhTLkJUkqlCEvSVKhDHlJkgplyEuSVChDXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKpQhL0lSoQx5SZIKZchLklQoQ16SpEIZ8pIkFcqQlySpUIa8JEmFMuQlSSqUIS9JUqEMeUmSCmXIS5JUKENekqRCGfKSJBXKkJckqVCGvCRJhTLkJUkqlCEvSVKhDHlJkgplyEuSVChDXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKpQhL0lSoQx5SZIKZchLklQoQ16SpEIZ8pIkFcqQlySpULWGfERMi4hvRsSaiHgkIj49SJ9DI+JrEfFvVZ+PNa17OiJWRcTKiPh+nbVKklSa8TW//k7gc5m5IiImAcsj4u7MfLSpzyeBRzPz7Ih4M/B4RPRn5s+q9fMyc1PNdUqSVJxa9+Qzc2NmrqiWtwJrgCMGdgMmRUQAPcBmGh8OJEnSCERmdueNInqB+4FZmbmlqX0ScBvwNmAS8NuZ+c/VuqeA52l8EPiHzFw8yOsuBBYCTJky5e1Lly4dsoZt27bR09PTqV9JLXDMu88x7z7HvPsc8z3mzZu3PDP7BltX93Q9ABHRA9wMXNQc8JUzgZXAO4Gjgbsj4l+qfnMyc0NE/GLV/lhm3t+8cRX8iwH6+vpy7ty5Q9axbNkyhluvznPMu88x7z7HvPsc89bUfnZ9RBxII+D7M/OWQbp8DLglG54AnqKxV09mbqgefwzcCpxad72SJJWi7rPrA7gOWJOZnx+i2zrgjKr/FOCtwJMRcXA1lU9EHAy8G1hdZ72SJJWk7un6OcD5wKqIWFm1XQpMB8jMa4A/B5ZExCoggIszc1NEHAXc2vicwHjgS5l5Z831SpJUjFpDPjMfoBHcw/XZQGMvfWD7k8CJNZUmSVLxvOOdJEmFMuQlSSqUIS9JUqEMeUmSCmXIS5JUKENekqRCGfKSJBXKkJckqVCGvCRJhTLkJUkqlCEvSVKhDHlJkgplyEuSVChDXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKpQhL0lSoQx5SZIKZchLklQoQ16SpELtNeQj4nealucMWLeojqIkSdLItbIn/9mm5asHrLuwg7VIkqQOaiXkY4jlwZ5LkqR9RCshn0MsD/ZckiTtI8a30OdtEfEwjb32o6tlqudH1VaZJEkakVZCfmbtVUiSpI7ba8hn5tqBbRFxOPBcZjpdL0nSPqqVS+hOi4hlEXFLRJwUEauB1cC/R8T8+kuUJEmvRyvT9X8LXAocCtwLvCczvx0RbwO+DNxZY32SJOl1auXs+vGZ+Y3M/D/AjzLz2wCZ+Vi9pUmSpJFoJeRfaVp+ccA6j8lLkrSPamW6/sSI2ELjkrmDqmWq5xNqq0ySJI1IK2fXj2vlhSLisMx8fuQlSZKkTujkt9Dd08HXkiRJI9TJkPc+9pIk7UM6GfKehCdJ0j6kkyEvSZL2IU7XS5JUqL2eXR8Rh2Tmloh402DrM3NztXhGRyuTJEkj0sp18l8CzgKW0zju3rzHnlRfN9sU9pIkaR/QynXyZ1WPR9ZfjiRJ6pRW9uR3i4gTgN7m7TLzlg7XJEmSOqDlkI+ILwInAI+w5372CRjykiTtg9rZkz8tM4+trRJJktRR7VxC91BEGPKSJO0n2tmTv4FG0P8IeInGWfaZmSfUUpkkSRqRdkL+i8D5wCpe/R3zkiRpH9ROyK/LzNtqq0SSJHVUOyH/WER8Cfgajel6wEvoJEnaV7UT8gfRCPd3N7V5CZ0kSfuolkM+Mz9WZyGSJKmz2rkZzvUM8p3xmXlhRyuSJEkd0c50/deblicAHwA2dLYcSZLUKe1M19/c/Dwivgz8345XJEmSOqKdO94NdAwwvVOFSJKkzmrnmPxW9nyffAI/Ai6uqS5JkjRC7UzXT6qzEEmS1Fl7DfmIOHm49Zm5onPlSJKkTmllT/5/DrMugXcOtTIipgE3Ar9E4373izPzqgF9DgX+kcbx/fHAlZl5fbVuPnAVMA64NjOvaKFeSZJEayG/IDNf76VyO4HPZeaKiJgELI+IuzPz0aY+nwQezcyzI+LNwOMR0Q+8DPwd8C5gPfC9iLhtwLaSJGkIrZxdf11EfDsiroiIuRHRznH8jbum8zNzK7AGOGJgN2BSRATQA2ym8eHgVOCJzHwyM38GLAXe3+p7S5I01kXma25i99pOEROAucB7gDnAOuBO4M7MXNfSG0X0AvcDszJzS1P7JOA24G3AJOC3M/OfI+JcYH5m/n7V73zgVzNz0YDXXQgsBJgyZcrbly5dOmQN27Zto6enp5Vy1SGOefc55t3nmHefY77HvHnzlmdm32DrWtorz8wdVKEOEBFH0gj8v42IX8rMU4fbPiJ6gJuBi5oDvnImsJLGsf2jgbsj4l9oXKr3mlIGqW0xsBigr68v586dO2Qdy5YtY7j16jzHvPsc8+5zzLvPMW/N67oZTmY+lZlfyMz3Ae8Yrm9EHEgj4PuH+FrajwG3ZMMTwFM09urXA9Oa+k3F2+hKktSyVi6h23UTnN1NNN0UJzMPGWbbAK4D1mTm54fotg44A/iXiJgCvBV4EvgJcEw1a/BD4DzgI3urV5IkNew15Ed4E5w5wPnAqohYWbVdSnU73My8BvhzYElErKLxweHizNwEEBGLgLtoXEL3xcx8ZAS1SJI0prSyJ39IZm6JiDcNtj4zNw+1bWY+wODH1pv7bADePcS624Hb91ajJEl6rVZOvPsScBawnD3T9LskcFQNdUmSpBFqZbr+rOrY+q+3ermcJEkafS2dXZ+Ni+lvrbkWSZLUQe1cQvftiDiltkokSVJHtXyLWmAe8AcRsRZ4gT2X0J1QS2WSJGlE2gn599RWhSRJ6rh2vmxmbfXd8u+gcVb9g36XvCRJ+66Wj8lHxH8HbgAmA4cD10fEf62rMEmSNDLtTNd/GDip+rIaIuIKYAXwF3UUJkmSRqads+ufBiY0PX8j8IOOViNJkjqmldvaXk3jGPxLwCMRcXf1/F3AA/WWJ0mSXq9Wpuu/Xz0u59U3xFnW8WokSVLHtHJb2xtaeaGIuDkzf2vkJUmSpE5o55j83vhFNZIk7UM6GfLZwdeSJEkj1MmQlyRJ+5BOhnzsvYskSeqWTob8xR18LUmSNEKtXCf/lcz8UESs4tXH3V/1LXSZ+Y2aapQkSa9DK9fJf7p6PKvOQiRJUme1cp38xupxLUBEHNLKdpIkaXS1HNYR8QfAnwEvsmfaPvH6eEmS9knt7JH/Z+C4zNxUVzGSJKlz2jm7/gfA9roKkSRJndXOnvwlwLci4js0vpEOgMz8VMerkiRJI9ZOyP8DcC+wCnilnnIkSVKntBPyOzPzs7VVIkmSOqqdY/LfjIiFEfHLEfGmXT+1VSZJkkaknT35j1SPlzS1eQmdJEn7qJZDPjOPrLMQSZLUWe3cDOejg7Vn5o2dK0eSJHVKO9P1pzQtTwDOAFYAhrwkSfugdqbr/6j5eUQcCvzvjlckSZI6YiTfJ78dOKZThUiSpM5q55j819jzxTQHAMcCX6mjKEmSNHLtHJO/sml5J7A2M9d3uB5JktQh7RyTv6/OQiRJUmftNeQjYit7pulftQrIzDyk41VJkqQR22vIZ+akbhQiSZI6ayRn10uSpH2YIS9JUqEMeUmSCmXIS5JUKENekqRCGfKSJBXKkJckqVCGvCRJhTLkJUkqlCEvSVKhDHlJkgplyEuSVChDXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKpQhL0lSoQx5SZIKZchLklQoQ16SpEKNr/PFI2IacCPwS8ArwOLMvGpAnz8GFjTVMxN4c2Zujoinga3Ay8DOzOyrs15JkkpSa8gDO4HPZeaKiJgELI+IuzPz0V0dMvOvgL8CiIizgc9k5uam15iXmZtqrlOSpOLUOl2fmRszc0W1vBVYAxwxzCYfBr5cZ02SJI0VkZndeaOIXuB+YFZmbhlk/URgPfAru/bkI+Ip4HkggX/IzMWDbLcQWAgwZcqUty9dunTIGrZt20ZPT8/Ifxm1zDHvPse8+xzz7nPM95g3b97yoQ5n1z1dD0BE9AA3AxcNFvCVs4EHB0zVz8nMDRHxi8DdEfFYZt7fvFEV/IsB+vr6cu7cuUPWsWzZMoZbr85zzLvPMe8+x7z7HPPW1H52fUQcSCPg+zPzlmG6nseAqfrM3FA9/hi4FTi1rjolSSpNrSEfEQFcB6zJzM8P0+9Q4NeBf2pqO7g6WY+IOBh4N7C6znolSSpJ3dP1c4DzgVURsbJquxSYDpCZ11RtHwC+kZkvNG07Bbi18TmB8cCXMvPOmuuVJKkYtYZ8Zj4ARAv9lgBLBrQ9CZxYS2GSJI0B3vFOkqRCGfKSJBXKkJckqVCGvCRJhTLkJUkqlCEvSVKhDHlJkgplyEuSVChDXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKpQhL0lSoQx5SZIKZchLklQoQ16SpEIZ8kPp74feXjjggMZjf/9oVyRJUlvGj3YB+6T+fli4ELZvbzxfu7bxHGDBgtGrS5KkNrgnP5jLLtsT8Lts395olyRpP2HID2bduvbaJUnaBxnyg5k+vb12SZL2QYb8YC6/HCZOfHXbxImNdkmS9hOG/GAWLIDFi2HGDIhoPC5e7El3kqT9imfXD2XBAkNdkrRfc09ekqRCGfKSJBXKkJckqVCGvCRJhTLkJUkqlCEvSVKhDHlJkgplyEuSVChDXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKpQhL0lSoQx5SZIKZchLklQoQ16SpEIZ8pIkFcqQlySpUIa8JEmFMuQlSSqUIS9JUqEMeUmSCmXIS5JUKENekqRCGfKSJBXKkJckqVCGvCRJhTLkJUkqlCEvSVKhDHlJkgplyEuSVChDXpKkQhnykiQVypCXJKlQtYZ8REyLiG9GxJqIeCQiPj1Inz+OiJXVz+qIeDki3lStmx8Rj0fEExHxJ3XWKklSaerek98JfC4zZwKnAZ+MiGObO2TmX2Xm7MycDVwC3JeZmyNiHPB3wHuAY4EPD9xWkiQNrdaQz8yNmbmiWt4KrAGOGGaTDwNfrpZPBZ7IzCcz82fAUuD9ddYrSVJJIjO780YRvcD9wKzM3DLI+onAeuBXqj35c4H5mfn71frzgV/NzEUDtlsILASYMmXK25cuXTpkDdu2baOnp6dDv5Fa4Zh3n2PefY559znme8ybN295ZvYNtm58NwqIiB7gZuCiwQK+cjbwYGZu3rXZIH1e84kkMxcDiwH6+vpy7ty5Q9axbNkyhluvznPMu88x7z7HvPsc89bUfnZ9RBxII+D7M/OWYbqex56pemjs1U9rej4V2ND5CiVJKlPdZ9cHcB2wJjM/P0y/Q4FfB/6pqfl7wDERcWREvIHGh4Db6qxXkqSS1D1dPwc4H1gVESurtkuB6QCZeU3V9gHgG5n5wq4NM3NnRCwC7gLGAV/MzEdqrleSpGLUGvKZ+QCDH1sf2G8JsGSQ9tuB2ztemCRJY4B3vJMkqVCGvKR69PdDby8ccEDjsb9/tCuSxpyuXEInaYzp74eFC2H79sbztWsbzwEWLBi9uqQxxj15SZ132WV7An6X7dsb7ZK6xpCX1Hnr1rXXLqkWhrykzps+vb12SbUw5CV13uWXw8SJr26bOLHRLqlrDHlJnbdgASxeDDNmQETjcfFiT7qTusyz6yXVY8ECQ10aZe7JS5JUKENekqRCGfKSJBXKkJckqVCGvCRJhTLkJUkqlCEvSVKhDHlJkgplyEuSVChDXpKkQkVmjnYNHRMRzwJrh+lyOLCpS+WowTHvPse8+xzz7nPM95iRmW8ebEVRIb83EfH9zOwb7TrGEse8+xzz7nPMu88xb43T9ZIkFcqQlySpUGMt5BePdgFjkGPefY559znm3eeYt2BMHZOXJGksGWt78pIkjRnFhHxETIuIb0bEmoh4JCI+XbW/KSLujoj/Vz0e1rTNJRHxREQ8HhFnjl71+7eIGBcR/xoRX6+eO+Y1iohfiIibIuKx6r/30x3zekXEZ6q/K6sj4ssRMcEx76yI+GJE/DgiVje1tT3GEfH2iFhVrftfERHd/l32JcWEPLAT+FxmzgROAz4ZEccCfwLck5nHAPdUz6nWnQccB8wHvhAR40al8v3fp4E1Tc8d83pdBdyZmW8DTqQx9o55TSLiCOBTQF9mzgLG0RhTx7yzltAYr2avZ4z/HlgIHFP9DHzNMaWYkM/MjZm5olreSuMP3xHA+4Ebqm43AOdUy+8HlmbmS5n5FPAEcGpXiy5AREwF3gtc29TsmNckIg4B/iNwHUBm/iwzf4JjXrfxwEERMR6YCGzAMe+ozLwf2Dygua0xjohfBg7JzIeyccLZjU3bjEnFhHyziOgFTgK+A0zJzI3Q+CAA/GLV7QjgmabN1ldtas/fAP8FeKWpzTGvz1HAs8D11SGSayPiYBzz2mTmD4ErgXXARuCnmfkNHPNuaHeMj6iWB7aPWcWFfET0ADcDF2XmluG6DtLmpQZtiIizgB9n5vJWNxmkzTFvz3jgZODvM/Mk4AWqKcwhOOYjVB0Hfj9wJPAW4OCI+J3hNhmkzTHvrKHG2LEfoKiQj4gDaQR8f2beUjX/ezWFQ/X446p9PTCtafOpNKbg1Lo5wPsi4mlgKfDOiPhHHPM6rQfWZ+Z3quc30Qh9x7w+vwE8lZnPZubPgVuA/4Bj3g3tjvH6anlg+5hVTMhXZ1BeB6zJzM83rboN+N1q+XeBf2pqPy8i3hgRR9I4QeO73aq3BJl5SWZOzcxeGifB3JuZv4NjXpvM/BHwTES8tWo6A3gUx7xO64DTImJi9XfmDBrn/Djm9WtrjKsp/a0RcVr1b/XRpm3GpPGjXUAHzQHOB1ZFxMqq7VLgCuArEfF7NP5n/U8AmflIRHyFxh/IncAnM/PlrlddJse8Xn8E9EfEG4AngY/R+MDumNcgM78TETcBK2iM4b/SuNtaD455x0TEl4G5wOERsR74H7y+vyWfoHGm/kHAHdXPmOUd7yRJKlQx0/WSJOnVDHlJkgplyEuSVChDXpKkQhnykiQVypCXxqiI2FbDa/5ZRPxGp19X0uvjJXTSGBUR2zKzZ7TrkFQf9+Ql7RYRyyKir1o+vLplMRFxQUR8NSK+FhFPRcSiiPhs9SU5346IN1X9lkTEudXyFRHxaEQ8HBFXVm1vjoibI+J71c+cqr0nIq6vvgf84Yj4rVEZAKkwJd3xTlK9ZtH4dscJNL7a8+LMPCki/prG7UP/ZlfHKvQ/ALwtMzMifqFadRXw15n5QERMB+4CZgL/jca3ux1fbX9Yd34lqWyGvKRWfTMzt9K4N/hPga9V7auAEwb03QLsAK6NiH8Gvl61/wZwbOO24gAcEhGTqvbzdjVm5vP1/ArS2GLIS2q2kz2H8SYMWPdS0/IrTc9fYcDfkszcGRGn0vgyl/OARcA7q9c+PTNfbO5ffZmIJwhJHeYxeUnNngbeXi2f+3pfJCJ6gEMz83bgImB2teobNAJ/V7+h2p2ulzrAkJfGrokRsb7p57PAlcAnIuJbwOEjeO1JwNcj4mHgPuAzVfungL7q5LpHgY9X7X8BHBYRqyPi34B5I3hvSRUvoZMkqVDuyUuSVChDXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKpQhL0lSoQx5SZIK9f8B/KnEpmR5ymkAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 =  10692.75 # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 =  3561.70  # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 =  9275.25  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  3184.71   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  7337.99  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  2534.85   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 149.67# Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 84.11 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 133.06 # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 72.53 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 116.85 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 63.34 # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.112*4.018*efficiency_bin1*0.8876)\n",
    "l_bin2 = N_bin2/(0.112*4.018*efficiency_bin2*0.8921)\n",
    "l_bin3 = N_bin3/(0.112*4.018*efficiency_bin3*0.8188)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "lbril_values = [116086.333 , 100081.51 , 93398.989]\n",
    "luminosity_errors = [(0.00156+(4.6506*math.pow(10,-6))+0.0235+(4.3467*math.pow(10,-7))) , (0.00161+(4.6506*math.pow(10,-6))+0.0235+(5.9759*math.pow(10,-7))) , (0.0019+(4.6506*math.pow(10,-6))+0.0235+(9.9927*math.pow(10,-7)))]\n",
    "print(\"lumi_bril\", lbril_values)\n",
    "print(\"lumi_BE\", l_values)\n",
    "rat = [lbril_values[0]/l_values[0], lbril_values[1]/l_values[1] , lbril_values[2]/l_values[2]]\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.errorbar(lumisec_midpoints, l_values, xerr=luminosity_errors, fmt='o', color='black',  capsize=5,label=\"lumi_BE\")\n",
    "# plt.errorbar(lumisec_midpoints, lbril_values , xerr=luminosity_errors, fmt='o', color='red',  capsize=5,label=\"lumi_bril\")\n",
    "plt.errorbar(lumisec_midpoints, rat , fmt='o', color='red',  capsize=5,label=\"lumi_bril/lumi_BE\")\n",
    "\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"lumi_bril/lumi_BE\")\n",
    "plt.legend()\n",
    "plt.grid()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "4e88ccb8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "lumi_BB [51416.39622437919, 49471.895749182724, 38033.19255240647]\n",
      "lumi_bril [116086.333, 100081.51, 93398.989]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAfIAAAFzCAYAAADFfYutAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/H5lhTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAcfElEQVR4nO3de5CddZ3n8fc3BOiEThATJjPmQgJDSZRLgEbBULOJ6AIa8Ma6rhmQcaYy6qB4q2WBXXedGhRrGcZZLYZNgcDMRlMOIIusgCzQUOHmJJnIrWFXhEAERwggCUlYYr77xzlJd5pO9znJec7h1/1+VXWdc37Pc57n299of3jukZlIkqQyjet0AZIkafcZ5JIkFcwglySpYAa5JEkFM8glSSqYQS5JUsHGd7qA3TF16tScPXv2kNNeffVV9ttvv/YWNMbZ886w7+1nz9vPnvdbtWrVC5l54ODxIoN89uzZrFy5cshpvb29LFiwoL0FjXH2vDPse/vZ8/az5/0iYu1Q4+5alySpYAa5JEkFM8glSSpYkcfIh/L666+zbt069t9/f/r6+jpdzpjSzp53dXUxY8YM9t5777asT5Le7EZNkK9bt45JkyYxZcoUJk+e3OlyxpQNGzYwadKkyteTmaxfv55169YxZ86cytcnSSUYNbvWt2zZwpQpU4iITpeiikQEU6ZMYcuWLZ0uRZLeNEZNkAOG+Bjgv7Ek7WxUBbkkSWPN2A3yZctg9mwYN672umzZHi+yu7t7j5cB8Oyzz3LGGWfscvrVV1/NOeec09CyPvCBD/Dyyy8Db6zvlFNO4Ve/+hULFizY5Q12mjVwfUPZa6+9mDdvHkcddRTHHHMM9957LwBPPfUUEyZM2DHtPe95D48//nhLapKk0WxsBvmyZbBkCaxdC5m11yVLWhLmrfC2t72Na6+9do+WkZls27aNn/zkJ7zlLW95w/TNmzfz4osvMn369D1az2C7Wt92EyZMYM2aNfz85z/nm9/8Jueff/6OaYcccsiOaZ/61Kf4xje+0dLaJKlyFWwkjmRsBvmFF8KmTTuPbdpUG2+B3t5eFi1atOPzOeecw9VXXw3Ubi97wQUXcMIJJ9DT08Pq1as5+eSTOeSQQ7j88suB2tbp4YcfPuw6nnnmGU455RTe/va38/Wvf33H9+bOncvnPvc5jjnmGJ555hlmz57NCy+8MGSNQ932cOBW+7XXXsvZZ58NwNlnn81nP/tZFi5cyMEHH8xdd93Fpz/9aebOnctnPvOZHd/Z1fqG8sorr3DAAQc0PU2S3pQ6tJE4ai4/a8rTTzc33mIzZ87kvvvu40tf+hJnn30299xzD1u2bOGd73znTqE4nJ/97Gc8/PDDTJw4keOOO44PfvCDTJ06lccff5yrrrqKyy67bNjv33zzzXz4wx9uqu6XXnqJO+64gxtvvJHTTjuNe+65hyuuuIJjjz2WNWvWMG/evBGXsXnzZubNm8eWLVt47rnnuOOOO3ZMe+KJJ5g3bx4bNmxg06ZNPPDAA03VJ0kdNdxG4uLFla12bG6Rz5rV3HiLnX766QAcccQRvPvd72bSpEkceOCBdHV1DXt8eaD3v//9TJkyhQkTJvDRj36UFStWAHDQQQdx/PHHj/j9e+65hxNPPLGpuk877TQigiOOOIJp06ZxxBFHMG7cOA477DCeeuqphpaxfdf6Y489xi233MJZZ51FZgL9u9afeOIJvv3tb7NkyZKm6pOkjurQRuLYDPKLLoKJE3cemzixNt4C48ePZ9u2bTs+D77ued999wVg3LhxO95v/7x169aG1jH4Mqztnxt53N8vf/lLZs6cyT777DPscquoe6ATTjiBF154geeff/4N004//XTuvvvuppcpSR3ToY3EsRnkixfD0qVw0EEQUXtdurRluz4OOuggHn30UV577TV++9vfcvvtt7dkuQPddtttvPjii2zevJkbbriB+fPnN/zdm2++mVNOOWXIadOmTaOvr49t27bxox/9qFXlDumxxx7jd7/7HVOmTHnDtBUrVnDIIYdUun5JaqmKNxJ3ZWweI4daaFd0zGLmzJl8/OMf58gjj+TQQw/l6KOPbvk6TjzxRM4880x+8Ytf8MlPfpKenp6Gd2/fcsstfOc73xly2sUXX8yiRYuYOXMmhx9+OBs3bmxh1f3HyKF2Zv0111zDXnvtBfQfI89M9tlnH6644oqWrluSKrU9Uy68sLY7fdasWohXeHwcILYfnyxJT09PDr7uua+vj7lz57btvt+leu2115g/f37LrhuH9t1rfbvt/9Zj3a6uPFB17Hn72fN+EbEqM3sGj4/NXetj2L777tvSEJckddbY3bVegFtvvZXzzjtvp7E5c+ZUfux6T61fv56TTjrpDeO33377kMfD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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "\n",
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.073*4.018*efficiency_bin1*0.8925)\n",
    "l_bin2 = N_bin2/(0.073*4.018*efficiency_bin2*0.8169)\n",
    "l_bin3 = N_bin3/(0.073*4.018*efficiency_bin3* 0.8143)\n",
    "lbril_values = [116086.333 , 100081.51 , 93398.989]\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "rat = [lbril_values[0]/l_values[0], lbril_values[1]/l_values[1] , lbril_values[2]/l_values[2]]\n",
    "luminosity_errors = [(0.00255+(5.4*math.pow(10,-6))+0.0235+(7.5935*math.pow(10,-7))) , (0.00257+(5.4*math.pow(10,-6))+0.0235+(1.3403*math.pow(10,-6))) , (0.0028+(5.4*math.pow(10,-6))+0.0235+(1.7005*math.pow(10,-6)))]\n",
    "print(\"lumi_BB\" , l_values)\n",
    "print(\"lumi_bril\" , lbril_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints, rat , fmt='o', color='red',  capsize=5,label=\"lumi_bril/lumi_BB\")\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"lumi_bril/lumi_BB\")\n",
    "plt.legend()\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "2fb5a68c",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [11684.14212370706, 10194.79585686655, 7801.4145289387825]\n",
      "lumi_bb [24708.215179851213, 21969.404332607905, 16828.162021434615]\n",
      "bril [116086.333, 100081.51, 93398.989]\n"
     ]
    },
    {
     "data": {
      "image/png": "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W1tmZh5//PH5wgsvZGbmQw89lFOnTs3MzI9//OM5e/bsDT+j4/Y6709mbrQPmZnnn39+3nTTTZmZOXr06Lz++uszM/OLX/xijh8/Pt98881cvnx57rfffpmZuWjRojz00EMzM/Omm27KMWPG5Ouvv56rV6/OAw88MJcsWZJ//OMfc9SoUbl8+fJcu3ZtTp06NX/yk5/k/Pnz84QTTtjws1977bUN+3r77bdv6MPLL7+cmZmtra35/ve/P995553MzDzmmGPyd7/73Xv2ras/L8D87OLfxJrflGl7d+ml0PnI0KpVlXp9fW36JElvv/12j+o9MWHCBF588UXmzJnDX/zFX2y07Je//CV33XUX11xzDVC5gmPJkiUccMABXHDBBTzxxBMMGDCAF154AYDJkydzzjnnsHbtWk477TQmTpzY7c8/44wzGDBgAK2trfz617/mjDPevVCuff/+8z//kzvuuAOAGTNmcMUVV2zVPn/iE58AYPz48bS2tjJ06FCGDh3KoEGDeP3119+z/rRp09hjjz0AOOSQQ1i8eDGvvvoqU6ZMYb/9Ks9xqq+v58EHH+Syyy7jD3/4AxdeeCEnn3wyJ554Ymlfdt11V44//njuvvtuDj74YNauXcv48eO3av8MC31syZKe1SWprzU3N1NXV8fixe99ZtDo0aNpbm7e6ssvP/GJT/DlL3+Z5uZmXn311Q31zOSOO+7ggx/84EbrX3nllQwbNownn3yS9evXM2jQIAA++tGP8uCDD/LTn/6UM888k7//+7/nrLPO2qh/nW9C1f4EyfXr17PnnnvyxBNPdNnHnuzjwIEDWb9+/SZ/5i677ALATjvttOFz+/eu5k50XGfAgAG0tbWRm3gK9F577cWTTz7JL37xC773ve8xd+5cbryx/G4An/nMZ/jHf/xHDjroID796U93v4PdcM5CHzvwwJ7VJakaZs2axZAhQzaqDRkyhFmz3nN7my1yzjnncPnll7/nN9qTTjqJ7373uxv+YXz88ccBeOONNxg+fDg77bQTt9xyC+vWVe7Dt3jxYvbff3/OO+88zj33XB577DGg8vyeBQsWsH79en7yk5902Yfdd9+dMWPGcPvttwOVoPLkk08CcOyxx3LrrbcCMHfu3G73Z/To0Tz77LO8/fbbvPHGG9x33309HZJufehDH+JXv/oVr7zyCuvWrWPOnDkcd9xxvPLKK6xfv55PfvKTfP3rX98wBh0NHTqUlStXbrStl156iX/7t3/baM7IljIs9LFZs6DT/48MGVKpS1Kt1NfX09jYyOjRo4kIRo8eTWNjI/W9dH505MiRfOELX3hP/bLLLmPt2rVMmDCBcePGcdlllwHw+c9/ntmzZ3P00UfzwgsvbDg60NzczMSJEzn88MO54447Nmzzm9/8JqeccgrHH388w4cP32Q/mpqauOGGGzjssMM49NBDN0yo/M53vsP3vvc9Jk+ezJtvvtnt/owaNYpPfepTTJgwgfr6eg4//PAej0l3hg8fztVXX83UqVM57LDDOOKIIzj11FP54x//yJQpU5g4cSJnn302V1999XvaNjQ08LGPfYypU6duqH3qU5/i2GOPZa+99nrP+j3W1UQGX703wTGzMplx9OjMiMq7kxu3jJPtqs8xr75qTHDcHJu73vagfdLk9ubkk0/Oe++9d5PLezLB0SMLVVBfDy++COvXV96d2CipVjZ3It/WTvhT7bz++uv8+Z//OYMHD2batGm9sk0nOErSDsTbPW//9txzzw1Xk/QWjyxIkqRShgVJklTKsCBJkkoZFiRJUinDgiSp1wwYMICJEyduuE9A+wOhuvLhD38Y2PghSz3V/jAl9S3DgiTtoPriibiDBw/miSee4Mknn+Tqq6/mkksuec867XdnLAsS6l8MC5K0A2pqgoYGWLy48jzcxYsr33sjMLR78803N9w9sLm5malTp/I3f/M3G24B3fEx0+3WrVvHl7/8ZcaPH8+ECRP47ne/C8BVV13F5MmTGTduHA0NDV0+R+HRRx/lwx/+MIcddhhHHXXURrc/1tbxPguStAPqqyfirl69mokTJ7JmzRqWLVvG/fffv2HZI488wtNPP82YMWM22b6xsZFFixbx+OOPM3DgQFasWAHABRdcwOWXXw7AmWeeyd13383HP/7xDe3eeecd/uqv/orbbrttwy2cBw8evOU7oo14ZEGSdkB99UTc9tMQzz33HD//+c8566yzNhwFOOqoo0qDAsC9997LZz/7WQYOrPwuu/feewPwwAMP8KEPfYjx48dz//3388wzz2zU7vnnn2f48OFMnjwZqDxEqn0b2nqOpCTtgA48sHLqoat6bznmmGN45ZVXePnll4F3Hx1dJjPf8+joNWvW8PnPf5758+czatQo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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "import math\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.31*2.018*efficiency_bin1*0.8708)\n",
    "l_bin2 = N_bin2/(0.31*2.018*efficiency_bin2*0.8625)\n",
    "l_bin3 = N_bin3/(0.31*2.018*efficiency_bin3*0.8629)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [(33508.88574846459+42953.99898400971+40181.36958173203),(29794.554336871133+37890.61341001629+27566.953653143104),(22822.083846539463+30042.71043743979+27566.953653143104)]\n",
    "l_evalues = [(0.02605540995+0.02506508527+0.02614507222),(0.0260759909+0.02511524819+0.02597520418),(0.0263063511+0.025405649869999998+0.02487161729)]\n",
    "luminosity_errors = [(0.00255+(0.000001585)+0.000141+(7.5935*math.pow(10,-7))) , (0.00257+(0.000001585)+0.000141+(1.3403*math.pow(10,-6))) , (0.0028+(0.000001585)+0.000141+(1.7005*math.pow(10,-6)))]\n",
    "lbril_values = [116086.333 , 100081.51 , 93398.989]\n",
    "lbb_values = [l_bin1,l_bin2,l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print (\"lumi_bb\",lbb_values)\n",
    "print(\"bril\",lbril_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints,lbb_values , xerr=l_evalues, fmt='o', color='black',label=\"Measured luminosity\"  ,capsize=5)\n",
    "plt.errorbar(lumisec_midpoints, lbril_values, fmt='o', color='blue', label=\"Brilcalc\", capsize=5)\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"$L_{total}$\")\n",
    "plt.legend()\n",
    "plt.grid()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13790cc8",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "4fb2322a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [11684.14212370706, 10194.79585686655, 7801.4145289387825]\n",
      "lumi_hltBB [24708.215179851213, 21969.404332607905, 16828.162021434615]\n",
      "errorlumi_hltBB [0.026051969350000002, 0.0260725503, 0.0263029105]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.31*2.018*efficiency_bin1*0.8708)\n",
    "l_bin2 = N_bin2/(0.31*2.018*efficiency_bin2*0.8625)\n",
    "l_bin3 = N_bin3/(0.31*2.018*efficiency_bin3*0.8629)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "\n",
    "luminosity_errors = [(0.00255+(1.21*math.pow(10,-6))+0.0235+(7.5935*math.pow(10,-7))) , (0.00257+(1.21*math.pow(10,-6))+0.0235+(1.3403*math.pow(10,-6))) , (0.0028+(1.21*math.pow(10,-6))+0.0235+(1.7005*math.pow(10,-6)))]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi_hltBB\" , l_values)\n",
    "print(\"errorlumi_hltBB\" , luminosity_errors)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints, l_values, xerr=luminosity_errors, fmt='o', color='black',  capsize=5)\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"L\")\n",
    "plt.grid()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ead5cd83",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
