{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "aded88e4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14036.20919795857, 12603.03564771506, 9767.858736758113]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE_hlt.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 10392.20   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 3370.69    # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 9293.67   # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 3057.84   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 7196.86   # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 2375.05   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 = 159.01  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 98.26   # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 142.85  # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 90.42   # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 121.28  # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 71.29   # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"Number  & luminosity  vs Lumisec_EE\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9dc95429",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14551.045985363908, 12733.332086577184, 10091.750918470183]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAgEAAAGDCAYAAACydsMvAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/H5lhTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAjqklEQVR4nO3de7xcZX3v8c+PJCZECEiiKRBgx0JVSAw0EbHetsVKbK14AQmNBSw0ingreONwWjhgjnqkh4oVPJEoKJGrIFSqYoUtbbmdQIlJQE6jBLKBcgm3BAyS5Hf+WGvjZDN77+wkMxPyfN6v17z2zO9Zz5pnPZPMfGetNTORmUiSpPJs1+kBSJKkzjAESJJUKEOAJEmFMgRIklQoQ4AkSYUyBEiSVChDgCRJhTIESB0SEedHxBc6dN8REd+OiMcj4tYBlnl5RNwdEWOGsd5bI2K/LTfSzomIN0fE3Z0eh9RKhgCpFhHLI+KhiHhpQ+24iOjp4LBa5U3AnwCTMvPAAZb5PPDtzFwDEBE9EbEmIvboWyAi3h4Ryxv6nAmc3qIxPy8iMiL2buV9ZOa/ZuarWnkfzdTh8LcRsToiVkXEbRHx1ob2YyJiXd3eeNmt3WPVi58hQNrQSOCTnR7EcEXEiGF22QtYnplPD7C+0cDRwIX9mp4G/naQ9V4NvC0idh3meLSh/5WZOwA7AecCV/R7jG/KzB36XR7ozFD1YmYIkDb0FeDTEbFz/4aI6KrfgY5sqPVExHH19WMi4t8j4qyIeCIifh0Rf1TXV0TEwxFxdL/VToiIn9bv+H4eEXs1rPvVddtj9W75DzS0nR8R50bEP0fE08Dbmox3t4i4uu6/LCL+uq4fC5wHvKF+B/k/mszD64EnMrO3X/1s4MiB3oXXew1uA97RZDyj63mZ0lB7eUT8JiJeERETIuKH9TKPRcS/RsSwnqMaH4/69jER8W8NtzMiPhoR/1nP+RkR8fsRcVNEPBURl0bES+pluyOit6Hv5yLi/rrf3RFxcF3fLiI+HxG/ioiV9Tp2aej3poi4sd6uFRFxzMZuT2auB74H7AJMHM5cSBvDECBtaCHQA3x6E/u/HvgFMJ7qyfti4HXA3sAHgX+MiB0alp8NnAFMAO4AFgDUhyR+Wq/jFcCRwDn9jrf/BTAX2BH4N17oIqAX2A04DPifEXFwZs4HPsLv3k2e2qTvVKDZ8fD7gW8Cpw0yB3cB0/oXM/NZ4Ip6W/p8APh5Zj4MnFSP9+VUL3j/DWjFj5vMBKYDBwGfBeZRPQ57AFP6jQ+AiHgV8DHgdZm5I3AIsLxu/gTwHuCtVHP9OPD1ut+ewI+Ar9XbtT/V47xR6nf/RwH3AA9t/CZKG8cQIL3Q3wEfj4iXb0LfezLz25m5DriE6oXl9Mx8NjOvBX5LFQj6XJOZN9QvkKdQvTvfA3gX1e76b2fm2sy8Hfg+1Yt5n6sy898zc33fcfs+9TreBHwuM9dk5h1U7/7/ciO3Y2dg1QBtXwT+fJATAFfV/Zv5Hhu+yP5FXQN4DtgV2Cszn6uPybciBHw5M5/KzKXAEuDazPx1Zj5J9YJ9QJM+64DRwL4RMSozl2fmr+q2DwOnZGZv/TieBhxW7zGaDfxLZl5Ub9PK+rEYyqcj4gmqwy//APxt/W+qz0H1noW+y6+arUQaiiFA6iczlwA/pDoxbrga3639pl5f/1rjnoAVDfe7GniM6t3kXsDrG5/oqV5Qfq9Z3yZ2Ax7LzMYX8nuB3TdyOx6n2sPwApn5CPCPDHwC4I7AEwO0XQdsHxGvrw997A9cWbd9BVgGXFsfStmU+d8Y/R+PwR4fADJzGfApqhf4hyPi4oYT8fYCrmx4nO6iCg0TqULgprxAn5mZOwPbAzOAr0TEOxvab87MnRsuv78J9yEZAqQBnAr8NRu+aPadRDe2odb4orwpGs+034Hq2O8DVC/wP+/3RL9DZh7f0Hewd8kPALtEROML+Z5Uu/M3xi+APxik/StU5yFMb9L2GmBRs071Me5LqfYG/AXww76gkpmrMvOkzHwl8OfAiX3H3Yfhabbs4/O8zPxeZr6J6kU/gS/XTSuAd/Z7rMZk5v112ya/QGdlCfDvwJ9t5iZIL2AIkJqo3/ldQnW8t6/2CNWL6AcjYkRE/BWb8QRf+9P6xLGXUJ0bcEtmrqDaE/EHEfGXETGqvrwuIl6zkeNfAdwIfDEixkTEa4Fjqc852Ai3AjtHRNM9B5n5BPD3VMfUnxfVpwqmU53PMJDvAUdQ7dnoOxRARLwrIvaOiACeono3va75KgB4Sb1tfZcRVMfb3xcRY+uTF48dfDM3TkS8KiL+uN6+NVR7DPrG9g1gbt9JnfXJjofWbQuAt0fEByJiZESMj4j9h3nfr6Y6tLN0S2yL1MgQIA3sdOCl/Wp/DXwGWAnsR/VCuzm+R7XX4TGqF8/ZUL0rpjrDfhbVu/r/onrnOXoY6z4S6Kr7XwmcmpmDvTg/LzN/C5xPdTLjQL7KC1+k3w30DPZxtcy8heod+25Ux+D77AP8C7AauAk4JzN7Brn/pVQvxn2XDwFnUZ138RBwARsfeoYyGvgS8CjVY/EKqhMXoZqHq6kOY6wCbqY6QZTMvA/4U6qTHh+jCikvOGmyic/Wn9x4GrgW+Dbwfxra+z7Z0Xh53WZuowoUrTnvRtKLXX1i5L8CB2Tmbzayzy3AsfUubElbOUOAJEmF8nCAJLVZRCxtsjt/dUTM7vTYVBb3BEiSVCj3BEiSVKiRQy+ybZkwYUJ2dXU1bXv66ad56Uv7nwyuVnLO28857wznvf2c88ptt932aGY2/QbU4kJAV1cXCxcubNrW09NDd3d3ewdUOOe8/ZzzznDe2885r0TEvQO1eThAkqRCGQIkSSqUIUCSpEIVd06AJGnzPffcc/T29rJmzZqhF+6QnXbaibvuuqvTw2ibMWPGMGnSJEaNGrXRfQwBkqRh6+3tZccdd6Srq4vqN5+2PqtWrWLHHZv+IvY2JzNZuXIlvb29TJ48eaP7eThAkjRsa9asYfz48VttAChNRDB+/Phh75kxBEiSNokBYOuyKY+HIUCS9KIUEZx00knP3z7zzDM57bTTttj6ly9fzpQpU7bY+vocd9xx3HnnnVt8vZvCECBJelEaPXo0V1xxBY8++minhzIs5513Hvvuu2+nhwEYAjbZggXQ1QXbbVf9XbCg0yOSpK1XK54zR44cyZw5czjrrLMGXGb9+vV0dXXxxBNPPF/be++9eeihh7jsssuYMmUK06ZN4y1vectG329XV9fzwWPhwoXPfyvhaaedxtFHH8073vEOurq6uOKKK/jsZz/L1KlTmTlzJs899xwA3d3dLFy4kHXr1nHMMccwZcoUpk6d+vx2/OpXv2LmzJlMnz6dN7/5zfzyl78E4KGHHuK9730v06ZNY9q0adx4443Dma6mDAGbYMECmDMH7r0XMqu/c+YYBCSpmVY+Z55wwgksWLCAJ598smn7dtttx6GHHsqVV14JwC233EJXVxcTJ07k9NNP5yc/+QmLFi3i6quv3vzBUL2AX3PNNVx11VV88IMf5G1vexuLFy9m++2355prrtlg2TvuuIP777+fJUuWsHjxYj70oQ8BMGfOHL72ta9x2223ceaZZ/LRj34UgE984hO89a1vZdGiRdx+++3st99+mz1eQ8AmOOUUeOaZDWvPPFPVJUkbauVz5rhx4zjqqKM4++yzB1zmiCOO4JJLLgHg4osv5ogjjgDgjW98I8cccwzf/OY3Wbdu3eYPBnjnO9/JqFGjmDp1KuvWrWPmzJkATJ06leXLl2+w7Ctf+Up+/etf8/GPf5wf//jHjBs3jtWrV3PjjTdy+OGHs//++/PhD3+YBx98EIDrrruO448/HoARI0aw0047bfZ4DQGb4L77hleXpJK1+jnzU5/6FPPnz+fpp59u2v6GN7yBZcuW8cgjj/CDH/yA973vfQB84xvf4Atf+AIrVqxg//33Z+XKlRt1fyNHjmT9+vUAL/hI3ujRo4FqD8SoUaOeP2N/u+22Y+3atRss+7KXvYxFixbR3d3N17/+dY477jjWr1/PzjvvzB133PH8pZVfeGQI2AR77jm8uiSVrNXPmbvssgsf+MAHmD9/ftP2iOC9730vJ554Iq95zWsYP348UO26f/3rX8/pp5/OhAkTWLFixUbdX1dXF7fddhsA3//+9zd53I8++ijr16/n/e9/P2eccQa3334748aNY/LkyVx22WVA9SVAixYtAuDggw/m3HPPBWDdunU89dRTm3zffQwBm2DuXBg7dsPa2LFVXZK0oXY8Z5500kmDfkrgiCOO4MILL3z+UADAZz7zGaZOncqUKVN4y1vewrRp017Q7+6772bSpEnPXy677DJOPfVUPvnJT/LmN7+ZESNGbPKY77//frq7u9l///055phj+OIXvwjAggULmD9/PtOmTWO//fbjqquuAuCrX/0q119/PVOnTmX69OksXbp0k+/7eZlZ1GX69Ok5kOuvv37Atv4uvDBzr70yI6q/F1640V3VYDhzri3DOe+MbW3e77zzzmEt34nnzKeeeqr1d7KVafa4AAtzgNdEfztgE82eXV0kSUPzOXPr5OEASZIKZQiQJKlQhgBJ0iapDjdra7Epj4chQJI0bGPGjGHlypUGga1EZrJy5UrGjBkzrH6eGChJGrZJkybR29vLI4880umhDGjNmjXDflF8MRszZgyTJk0aVh9DgCRp2EaNGsXkyZM7PYxB9fT0cMABB3R6GFs1DwdIklQoQ4AkSYUyBEiSVChDgCRJ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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 =  10692.75 # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 =  3561.70  # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 =  9275.25  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  3184.71   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  7337.99  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  2534.85   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 149.67# Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 84.11 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 133.06 # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 72.53 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 116.85 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 63.34 # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"Number of (N) vs Lumisec_BE\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "51c6e925",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [11684.14212370706, 10194.79585686655, 7801.4145289387825]\n"
     ]
    },
    {
     "data": {
      "image/png": "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ctppp/GP//iPXHPNNVx66aVPvTF03sC/8Y1vcMkll/D617+eF7/4xVx77bXstNNOfOMb33jCtldffTW33norK1as4Nprr+WNb3wjAIsXL+YTn/gEV155Jaeffjp/9md/BsDb3/52XvSiF3HNNddw1VVXcdBBBz3l9hoCNsH73gcPPfTEsoce6pRLkp6on6+Zu+66K8cddxxnnnnmpNu89rWv5ctf/jIA559/Pq997WsBeOELX8gJJ5zApz/9adatW/fUGwO87GUvY/vtt2fevHmsW7eOhQsXAjBv3jxuuummJ2z77Gc/m5///Oe87W1v4x/+4R/YddddWbNmDT/84Q855phjOOSQQ3jLW97C6tWrAfjud7/LSSedBMC0adPYbbfdnnJ7DQGb4Oabp1YuSW3W79fMd77znZx99tk8+OCDPetf8IIXsGrVKu68806+9rWv8apXvQqAT33qU3zwgx/klltu4ZBDDuGuu+7aqMebPn06jz32GMCTvpK3ww47AJ0rENtvv/3jM/a322471q5d+4Rtd999d6655hpGRkb4u7/7O970pjfx2GOP8fSnP52rr7768aWfP3hkCNgE++03tXJJarN+v2busccevOY1r+Hss8/uWZ+Eo48+mne9610897nPZc899wQ6l+6f//znc9ppp7HXXntxyy23bNTjzZ49myuvvBKAiy66aJPb/ctf/pLHHnuMP/7jP+YDH/gAV111Fbvuuitz5szhwgsvBDo/AnTNNdcAcOSRR3LWWWcBsG7dOu6///5NfuxxhoBNsGQJzJjxxLIZMzrlkqQnGsRr5imnnLLebwm89rWv5Ytf/OLjQwEAf/VXf8W8efOYO3cuRxxxBAcffPCT9rvhhhuYNWvW48uFF17Iqaeeyjve8Q4OP/xwpk2btsltvvXWWxkZGeGQQw7hhBNO4EMf+hAAy5Yt4+yzz+bggw/moIMO4pJLLgHg4x//ON/73veYN28e8+fPZ+XKlZv82I+rqlYt8+fPr8l873vfm7Ruoi9+sWr//auSzu0Xv7jRu6rLVPpcm4d9PhzbWr9fd911U9p+GK+Z999/f/8fZAvT63kBltck74n+7YBNdOyxnUWStGG+Zm6ZHA6QJKmlDAGSJLWUIUCStEk6w83aUmzK82EIkCRN2Y477shdd91lENhCVBV33XUXO+6445T2c2KgJGnK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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"Number of (N) vs Lumisec_BB\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "99e935c7",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
