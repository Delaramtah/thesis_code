{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "aded88e4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14036.20919795857, 12603.03564771506, 9767.858736758113]\n",
      "lumi [40452.554757358, 36151.21170168409, 27566.953653143104]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE_hlt.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 10392.20   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 3370.69    # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 9293.67   # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 3057.84   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 7196.86   # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 2375.05   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 = 159.01  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 98.26   # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 142.85  # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 90.42   # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 121.28  # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 71.29   # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints, l_values, marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisection\")\n",
    "plt.ylabel(\"luminosity\")\n",
    "plt.title(\"luminosity  vs Lumisection\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "9dc95429",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14551.045985363908, 12733.332086577184, 10091.750918470183]\n",
      "lumi [31544.959148721486, 27604.368847586757, 21877.731043006734]\n"
     ]
    },
    {
     "data": {
      "image/png": "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eOHG11deeSWXXXbZNlv+okWLGDVq1DZbXptzzjmHxx9/fJsvd0sYAiRJO6RddtmFu+66ixdeeKHRTemR6667jkMOOaTRzQAMAVuupQWamqBPn+K5paXRLZKk7VY93jL79evHlClTuOqqqzqdZsOGDTQ1NfHKK69srB100EE8++yz3HHHHYwaNYoxY8Zw7LHHdnu9TU1NG4PH7NmzN16V8LLLLuOMM87guOOOo6mpibvuuovPfOYzjB49mkmTJrF27VoAJkyYwOzZs1m/fj1nnnkmo0aNYvTo0Ru347e//S2TJk1i3LhxHHPMMfz6178G4Nlnn+Xkk09mzJgxjBkzhl/84hc96a4OGQK2REsLTJkCixdDZvE8ZYpBQJI6UM+3zPPOO4+WlhZeffXVDsf36dOHE088ke9973sAzJo1i6amJoYOHcrll1/Of/3XfzFv3jxmzpy59Y2h+AD/4Q9/yN13382HPvQh3vOe9zB//nx22203fvjDH24y7dy5c3n66ad59NFHmT9/PmeddRYAU6ZM4Zvf/CYPP/wwV155JX/zN38DwKc+9Sne/e53M2/ePObMmcPIkSO3ur2GgC1xySWwevWmtdWri7okaRP1fMscOHAgp59+OldffXWn05x22mncdtttANx6662cdtppABx99NGceeaZfOtb32L9+vVb3xjgz//8z+nfvz+jR49m/fr1TJo0CYDRo0ezaNGiTaZ9+9vfzu9+9zs++clPcs899zBw4EBWrVrFL37xC0499VTGjh3Lxz72MZYvXw7A/fffz7nnngtA3759GTRo0Fa31xCwJZYs6Vldkiqs3m+ZF1xwAdOnT+e1117rcPxRRx3FggULeP7555kxYwZ/9Vd/BcC//du/8aUvfYmlS5cyduxYXnzxxW6tr1+/fmzYsAHgTT/J22WXXYBiD0T//v03nrHfp08f1q1bt8m0e+21F/PmzWPChAn867/+K+eccw4bNmxgzz33ZO7cuRsf9bzgkSFgSxxwQM/qklRh9X7L3HvvvfnABz7A9OnTOxwfEZx88sl8+tOf5p3vfCeDBw8Gil33f/Inf8Lll1/OkCFDWLp0abfW19TUxMMPPwzAd7/73S1u9wsvvMCGDRt4//vfzxe/+EXmzJnDwIEDGTFiBHfccQdQXARo3rx5AEycOJFrr70WgPXr17NixYotXncbQ8CWmDoVBgzYtDZgQFGXJG2iN94yL7zwwi5/JXDaaadx8803bzwUAHDRRRcxevRoRo0axbHHHsuYMWPeNN+TTz7J8OHDNz7uuOMOLr30Us4//3yOOeYY+vbtu8Vtfvrpp5kwYQJjx47lzDPP5B//8R8BaGlpYfr06YwZM4aRI0dy9913A/CNb3yDBx54gNGjRzNu3Dgee+yxLV73RplZqce4ceOyMw888ECn497k5pszDzwwM6J4vvnm7s+rjXrU59om7PPG2Nn6/fHHH+/R9I14y1yxYkX9V7Kd6ejvAszOTj4TvXfAlmpuLh6SpM3yLXP75OEASZIqyhAgSVJFGQIkSaooQ4AkSRVlCJAkqaIMAZKkHdLuu+++TZfXdmOfbWnmzJl8+ctf3qbL3Jb8iaAkSXXyvve9j/e9732Nbkan3BMgSaq/Xrr9+mc/+1muueaaja8vu+wyvva1r7F8+XKOPfZYxo4dy6hRo/jZz37WreVddtllXHnllRtfjxo1ikWLFrFo0SLe8Y53cM455zBq1Ciam5v5yU9+wtFHH83BBx/MQw89BMANN9zAJz7xCYAOb128fv16LrroIg4//HAOPfRQ/v3f/33juv7pn/6J0aNHM2bMGC6++OKt7puOuCdAklRfbfcSbruVYNu9hGGbX0Fo8uTJXHDBBRtvv3v77bdzzz33cMstt3D88cdzySWXsH79ela3v63hFliwYAF33HEH06ZN4/DDD+eWW27h5z//OTNnzuSKK65gxowZm0zfduviYcOG8corrwAwffp0Bg0axK9+9Stef/11jj76aI477jh+/etfM2PGDGbNmsWAAQN46aWXtrq9HTEESJLqq6t7CW/jEHDYYYfx3HPP8cwzz7Bo0SL22msvDjjgAA4//HA+8pGPsHbtWk466STGjh271esaMWIEo0ePBmDkyJFMnDiRiOjwtsHwxq2LP/CBD2y8k+G9997LI488wp133gnAq6++ylNPPcVPfvITzjrrLAaUN13Ye++9t7q9HfFwgCSpvnr59uunnHIKd955J3fddReTJ08G4Nhjj+WnP/0pw4YN48Mf/jA33XRTt5ZVe9tg2PTWwW23DYbiVsG1txFuf9tg6PjWxZnJN7/5zY23DV64cCHHHXccmbnxNsT1ZAiQJNVXL99+ffLkydx6663MmDGDU045BYDFixfztre9jY9+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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 =  10692.75 # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 =  3561.70  # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 =  9275.25  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  3184.71   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  7337.99  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  2534.85   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 149.67# Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 84.11 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 133.06 # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 72.53 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 116.85 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 63.34 # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints, l_values, marker='o', color='red', label='l vs Lumisec')\n",
    "\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N produce & luminosity vs Lumisec_BE\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "51c6e925",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [11684.14212370706, 10194.79585686655, 7801.4145289387825]\n"
     ]
    },
    {
     "data": {
      "image/png": "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ixdz3nnnTbjOhg0bGBoa4he/+MVztYMOOogHHniAK664gjlz5jBv3jyOOuqoLX7eoaGh54LHihUrnvtWwrPPPpuTTz6Z3//932doaIirr76aP/uzP2Pu3LksXLiQZ599FoDh4WFWrFjB+vXrOeWUU5gzZw5z58597nX85Cc/YeHChcyfP58jjzySf/mXfwHggQce4Pjjj2fevHnMmzeP733ve5Np17gMAVth+XJYvBh+9jOo6twvXmwQkKTx9PJn5umnn87y5ct57LHHxh3fZZddOPbYY/nKV74CwI033sjQ0BAzZ87knHPO4Z/+6Z+49dZbufbaa1/8ZOj8Av/617/ONddcwzve8Q5+7/d+j9tuu43dd9+dr3/9689b95ZbbuG+++5j5cqV3Hbbbbzzne8EYPHixXzmM5/hpptu4txzz+VP/uRPADjjjDP43d/9XW699VZuvvlmDj300Bc9X0PAVvjYx+Cpp55fe+qpTl2S9Hy9/Jk5Y8YMTjrpJM4///wJ13nb297Gl7/8ZQAuu+wy3va2twHw+te/nlNOOYXPf/7zrF+//sVPBviDP/gDdt11V+bOncv69etZuHAhAHPnzuXuu+9+3rqvetWr+OlPf8r73/9+/vEf/5EZM2awdu1avve973HCCSdw2GGH8Z73vIc1a9YA8K1vfYvTTjsNgClTprDnnnu+6PkaArbCPfdMri5Jbdbrn5kf/OAHWbZsGU8++eS446973etYvXo1Dz30EF/96ld585vfDMDnPvc5PvGJT3Dvvfdy2GGH8cgjj2zR802dOpUNGzYAvOAjebvtthvQOQKx6667PnfF/i677MK6deuet+5ee+3FrbfeyvDwMH/zN3/DqaeeyoYNG3jZy17GLbfc8tytl194ZAjYCgceOLm6JLVZr39m7r333vzhH/4hy5YtG3c8Cccffzwf/vCHefWrX80+++wDdA7d//Zv/zbnnHMO++67L/fee+8WPd/Q0BA33XQTAFddddVWz/vhhx9mw4YNvOUtb+HjH/84N998MzNmzGD27NlcccUVQOdLgG699VYAjj76aC644AIA1q9fz+OPP77Vz72RIWArLFkC06c/vzZ9eqcuSXq+fvzMPPPMMzf5KYG3ve1tXHLJJc+dCgD40z/9U+bOncucOXM46qijmDdv3gu2u/POO5k1a9ZztyuuuIKzzjqL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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_HLT vs Lumisec_BB\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "99e935c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "from pandas import json_normalize\n",
    "\n",
    "# Load JSON data (assuming nested structure)\n",
    "with open('input_file.json', 'r') as file:\n",
    "    json_data = pd.read_json(file)\n",
    "\n",
    "# Flatten the nested JSON (example if contacts are nested inside 'run_data')\n",
    "df = json_normalize(json_data, \n",
    "                    meta=['run:fill', 'time', 'nls', 'ncms' , 'delivered(/ub)' , ' recorded(/ub)'],\n",
    "                    errors='ignore')\n",
    "\n",
    "# Display the table\n",
    "print(df)\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
