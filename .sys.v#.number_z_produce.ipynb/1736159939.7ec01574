{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "aded88e4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14036.20919795857, 12603.03564771506, 9767.858736758113]\n",
      "lumi [40452.554757358, 36151.21170168409, 27566.953653143104]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE_hlt.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 10392.20   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 3370.69    # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 9293.67   # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 3057.84   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 7196.86   # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = 2375.05   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 = 159.01  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 98.26   # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 142.85  # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 90.42   # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 121.28  # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 71.29   # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints,N_values , marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_HLT vs Lumisec_EE\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "9dc95429",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14551.045985363908, 12733.332086577184, 10091.750918470183]\n",
      "lumi [31544.959148721486, 27604.368847586757, 21877.731043006734]\n"
     ]
    },
    {
     "data": {
      "image/png": "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sGDBa59KeO655zJr1iw+8IEP0NXVxfXXX8/nPvc5Jk+ezPTp01mzZg0A3d3dLFiwgHXr1nHiiScyadIkJk+e/Nrz+NWvfsX06dOZOnUqhx56KL/85S8BeOaZZzj66KOZMmUKU6ZM4Y477hhKu5oyBGyG+fNh9mx4/HHIrH7Onm0QkKRmWvmaeeqppzJ//nxefvnlpuuHDRvGkUceyfe//30A7r77brq6uhg/fjznnXceP/nJT1i4cCE33njjlk+G6hf4TTfdxA033MDxxx/P+973PhYtWsROO+3ETTfdtMG2999/P08++SQPPPAAixYt4mMf+xgAs2fP5utf/zr33nsvF1xwAX/+538OwGmnncbv/d7vsXDhQu677z4OPPDALZ6vIWAznH02rFq1YW3VqqouSdpQK18zR48ezQknnMBFF1004DbHHXccV199NQBXXXUVxx13HADvfe97OfHEE/nmN7/JunXrtnwywB/+4R+yww47MHnyZNatW8f06dMBmDx5Mo899tgG2771rW/lkUce4dOf/jQ//vGPGT16NCtXruSOO+7g2GOP5aCDDuITn/gETz/9NAC33norp5xyCgDDhw9nzJgxWzxfQ8BmeOKJodUlqWStfs38zGc+w7x583jllVearn/Pe97DkiVLeO655/jBD37Ahz/8YQC+8Y1v8MUvfpGlS5dy0EEHsWzZsk16vBEjRrB+/XqA170lb8cddwSqIxA77LDDa1fsDxs2jLVr126w7e67787ChQvp7u7mn/7pnzj55JNZv349u+22G/fff/9rt1Z+4JEhYDPss8/Q6pJUsla/Zu6xxx78yZ/8CfPmzWu6PiI4+uijOeOMM3j729/O2LFjgerQ/bvf/W7OO+88xo0bx9KlSzfp8bq6urj33nsB+N73vrfZ837++edZv349H/nIRzj//PO57777GD16NBMnTuTaa68Fqg8BWrhwIQCHH344l1xyCQDr1q1j+fLlm/3YfQwBm2HOHBg1asPaqFFVXZK0oXa8Zp555pkbfZfAcccdxxVXXPHaqQCAz372s0yePJlJkyZx2GGHMWXKlNeNe/jhh5kwYcJrt2uvvZZzzjmH008/nUMPPZThw4dv9pyffPJJuru7OeiggzjxxBP50pe+BMD8+fOZN28eU6ZM4cADD+SGG24A4Gtf+xq33XYbkydPZurUqTz4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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 =  10692.75 # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 =  3561.70  # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 =  9275.25  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  3184.71   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  7337.99  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  2534.85   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 149.67# Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 84.11 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 133.06 # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 72.53 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 116.85 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 63.34 # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_HLT vs Lumisec_BE\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "51c6e925",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [11684.14212370706, 10194.79585686655, 7801.4145289387825]\n"
     ]
    },
    {
     "data": {
      "image/png": "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+cM//EOGhoa44oor+Ou//msWLlzIkiVLeO655wAYHh5m9erVbNy4kVNOOYUFCxawcOHC51/Hz3/+c5YsWcKiRYs46qij+Nd//VcAHnzwQY477jgOO+wwDjvsMH74wx9OpV0TMgRsg1WrYPlyuOceqOrcL19uEJCkifTyZ+Zpp53GqlWrePzxxycc32233Vi6dCnf/OY3AbjhhhsYGhpizpw5nHnmmfzTP/0Tt9xyC1ddddVLnwydX+BXX301V155Je985zv5gz/4A2699Vb23HNPrr766hese/PNN3P//fezZs0abr31Vv70T/8UgOXLl/P5z3+eG2+8kbPOOou/+Iu/AOCDH/wgv//7v88tt9zCTTfdxKGHHvqS52sI2Aaf+AQ8/fQLa08/3alLkl6olz8zZ82axUknncQ555wz6TonnHAC3/jGNwC4+OKLOeGEEwB44xvfyCmnnMKXvvQlNm7c+NInA/zRH/0Ru+++OwsXLmTjxo0sWbIEgIULF3L33Xe/YN1Xv/rV/OIXv+ADH/gA3/nOd5g1axbr16/nhz/8IccffzyHH344733ve1m3bh0A1113HaeeeioA06ZNY++9937J8zUEbIN7751aXZLarNc/Mz/84Q9z3nnn8dRTT004/oY3vIG1a9fy8MMP861vfYu3vvWtAHzxi1/k05/+NPfddx+HH344jz766FY93/Tp09m0aRPAiz6St8ceewCdIxC7777781fs77bbbmzYsOEF6+6zzz7ccsstDA8P8/d///e85z3vYdOmTbziFa/g5ptvfv7Wyy88MgRsgwMPnFpdktqs1z8z9913X/7kT/6E8847b8LxJBx33HF85CMf4bWvfS2zZ88GOofuf/d3f5czzzyT/fbbj/vuu2+rnm9oaIgbb7wRgMsvv3yb5/3II4+wadMm3va2t/GpT32Km266iVmzZjF//nwuvfRSoPMlQLfccgsAxxxzDOeeey4AGzdu5Iknntjm5x5jCNgGK1bAzJkvrM2c2alLkl6oHz8zTz/99M1+SuCEE07gwgsvfP5UAMBHP/pRFi5cyIIFCzj66KM57LDDXrTdnXfeybx5856/XXrppZxxxhl86EMf4qijjmLatGnbPOf777+f4eFhDj/8cE455RT+5m/+BoBVq1Zx3nnncdhhh3HooYdy5ZVXAvC5z32O733veyxcuJBFixZx2223bfNzP6+qWnVbtGhRTeZ73/vepGPjXXhh1UEHVSWd+wsv3OpN1WUqPdf2Yc8HY1fr++233z6l9QfxM/OJJ57o/ZPsYCb6dwFW1yS/E/3bAdvoxBM7N0nSlvkzc8fk6QBJklrKECBJUksZAiRJ26Rzulk7im359zAESJKmbMaMGTz66KMGgR1EVfHoo48yY8aMKW3nhYGSpCmbN28eo6OjPPzww4OeyqSeeeaZKf9S3JnNmDGDefPmTWkbQ4Akacp233135s+fP+hpbNbIyAive93rBj2NHVrPTgck+UqSh5Ks6aodn+S2JJuSLO6qDyX5dZKbm9sXu8YWJbk1ydok56T5DsYkeyT5RlO/IclQr16LJEm7ol5eE3A+sGRcbQ3wVuAHE6z/86o6vLm9r6t+LrAcOLi5je3z3cBjVfUa4Gzgs9tx7pIk7fJ6FgKq6gfAL8fV7qiqO7d2H0n2B2ZV1fXNtx59DXhLM7wUuKBZvgw4ZuwogSRJ2rId6dMB85P8JMn3kxzV1OYCo13rjDa1sbH7AKpqA/A4MLtfk5UkaWe3o1wYuA44sKoeTbII+FaSQ4GJ3tmPfR5lc2MvkGQ5nVMKzJkzh5GRkQknsX79+knH1Bv2vP/s+WDY9/6z51u2Q4SAqnoWeLZZvjHJz4HfpvPOv/vzDvOAB5rlUeAAYDTJdGBvxp1+6Nr/SmAlwOLFi2t4eHjCeYyMjDDZmHrDnvefPR8M+95/9nzLdojTAUlemWRas/xqOhcA/qKq1gFPJjmyOd9/EnBls9lVwMnN8tuB68pvrZAkaav17EhAkouAYWC/JKPAGXTeqX8eeCVwdZKbq+pY4GjgzCQbgI3A+6pq7F39qXQ+abAncE1zAzgP+HqStc1+l/XqtUiStCvqWQioqndMMvTNCda9HLh8kv2sBhZMUH8GOP6lzFGSpDbbIU4HSJKk/jMESJLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS1lCJAkqaUMAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS1lCJAkqaUMAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS1lCJAkqaUMAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWqpnoWAJF9J8lCSNV2145PclmRTksXj1v94krVJ7kxybFd9UZJbm7FzkqSp75HkG039hiRDvXotkiTtinp5JOB8YMm42hrgrcAPuotJDgGWAYc223whybRm+FxgOXBwcxvb57uBx6rqNcDZwGe3/0uQJGnX1bMQUFU/AH45rnZHVd05wepLgYur6tmqugtYCxyRZH9gVlVdX1UFfA14S9c2FzTLlwHHjB0lkCRJW7ajXBMwF7iv6/FoU5vbLI+vv2CbqtoAPA7M7vlMJUnaRUwf9AQaE72Dr83UN7fNi3eeLKdzSoE5c+YwMjIy4STWr18/6Zh6w573nz0fDPvef/Z8y3aUEDAKHND1eB7wQFOfN0G9e5vRJNOBvRl3+mFMVa0EVgIsXry4hoeHJ5zEyMgIk42pN+x5/9nzwbDv/WfPt2xHOR1wFbCsueJ/Pp0LAH9cVeuAJ5Mc2ZzvPwm4smubk5vltwPXNdcNSJKkrdCzIwFJLgKGgf2SjAJn0Hmn/nnglcDVSW6uqmOr6rYklwC3AxuA06pqY7OrU+l80mBP4JrmBnAe8PUka5v9LuvVa5EkaVfUsxBQVe+YZOibk6y/AlgxQX01sGCC+jPA8S9ljpIktdmOcjpAkiT1mSFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUkv1LAQk+UqSh5Ks6artm+S7SX7W3O/T1IeS/DrJzc3ti13bLEpya5K1Sc5Jkqa+R5JvNPUbkgz16rVIkrQr6uWRgPOBJeNqHwOuraqDgWubx2N+XlWHN7f3ddXPBZYDBze3sX2+G3isql4DnA18dvu/BEmSdl09CwFV9QPgl+PKS4ELmuULgLdsbh9J9gdmVdX1VVXA17q26d7XZcAxY0cJJEnSlvX7moA5VbUOoLl/VdfY/CQ/SfL9JEc1tbnAaNc6o01tbOy+Zl8bgMeB2b2cvCRJu5Lpg55AYx1wYFU9mmQR8K0khwITvbOv5n5zYy+QZDmdUwrMmTOHkZGRCSexfv36ScfUG/a8/+z5YNj3/rPnW9bvEPBgkv2ral1zqP8hgKp6Fni2Wb4xyc+B36bzzn9e1/bzgAea5VHgAGA0yXRgb158+oFmnyuBlQCLFy+u4eHhCSc3MjLCZGPqDXvef/Z8MOx7/9nzLev36YCrgJOb5ZOBKwGSvDLJtGb51XQuAPxFc8rgySRHNuf7TxrbZty+3g5c11w3IEmStkLPjgQkuQgYBvZLMgqcAXwGuCTJu4F7geOb1Y8GzkyyAdgIvK+qxt7Vn0rnkwZ7Atc0N4DzgK8nWUvnCMCyXr0WSZJ2RT0LAVX1jkmGjplg3cuByyfZz2pgwQT1Z/hNiJAkSVPkNwZKktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFA0sCsWgVDQ7Dbbp37VasGPSOpXaYPegKS2mnVKli+HJ5+uvP4nns6jwFOPHFw85LaxCMBkgbiE5/4TQAY8/TTnbqk/jAESBqIe++dWl3S9mcIkDQQBx44tbqk7c8QIGkgVqyAmTNfWJs5s1OX1B+GAEkDceKJsHIlHHQQJJ37lSu9KFDqJz8dIGlgTjzRX/rSIHkkQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS1lCJAkqaV6FgKSfCXJQ0nWdNX2TfLdJD9r7vfpGvt4krVJ7kxybFd9UZJbm7FzkqSp75HkG039hiRDvXotkiTtinp5JOB8YMm42seAa6vqYODa5jFJDgGWAYc223whybRmm3OB5cDBzW1sn+8GHquq1wBnA5/t2SuRJGkX1LMQUFU/AH45rrwUuKBZvgB4S1f94qp6tqruAtYCRyTZH5hVVddXVQFfG7fN2L4uA44ZO0ogSZK2rN9fGzynqtYBVNW6JK9q6nOBH3WtN9rUnmuWx9fHtrmv2deGJI8Ds4FHxj9pkuV0jiYwZ84cRkZGJpzc+vXrJx1Tb9jz/rPng2Hf+8+eb9mO8rcDJnoHX5upb26bFxerVgIrARYvXlzDw8MTTmJkZITJxtQb9rz/7Plg2Pf+s+db1u9PBzzYHOKnuX+oqY8CB3StNw94oKnPm6D+gm2STAf25sWnHyRJ0iT6HQKuAk5ulk8GruyqL2uu+J9P5wLAHzenDp5McmRzvv+kcduM7evtwHXNdQOSJGkr9Ox0QJKLgGFgvySjwBnAZ4BLkrwbuBc4HqCqbktyCXA7sAE4rao2Nrs6lc4nDfYErmluAOcBX0+yls4RgGW9ei2SJO2KehYCquodkwwdM8n6K4AVE9RXAwsmqD9DEyIkSdLU+Y2BkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUktt9q8IJvlPmxmuqvrUdp6PJEnqky39KeGnJqjNBN4DzAYMAZIk7aQ2GwKq6m/HlpPsBXwI+DPgYuBvJ9tOkiTt+LZ0JIAk+wIfAU4ELgBeX1WP9XpikiSpt7Z0TcB/Bt4KrAQWVtX6vsxKkiT13JY+HXA68FvA/wY8kOSJ5vZkkid6Pz1JktQrW7omwI8QSpK0i/KXvCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLTWQEJDkQ0nWJLktyYeb2ieT3J/k5ub25q71P55kbZI7kxzbVV+U5NZm7JwkGcDLkSRpp9T3EJBkAfDnwBHAYcAfJzm4GT67qg5vbv/YrH8IsAw4FFgCfCHJtGb9c4HlwMHNbUn/XokkSTu3QRwJeC3wo6p6uqo2AN8HjtvM+kuBi6vq2aq6C1gLHJFkf2BWVV1fVQV8DXhLj+cuSdIuY7N/QKhH1gArkswGfg28GVgNPAq8P8lJzePTq+oxYC7wo67tR5vac83y+PqLJFlO54gBc+bMYWRkZMKJrV+/ftIx9YY97z97Phj2vf/s+Zb1PQRU1R1JPgt8F1gP3AJsoHNo/1NANfd/C/wZMNF5/tpMfaLnXAmsBFi8eHENDw9POLeRkREmG1Nv2PP+s+eDYd/7z55v2UAuDKyq86rq9VV1NPBL4GdV9WBVbayqTcCX6FwzAJ13+Ad0bT4PeKCpz5ugLkmStsKgPh3wqub+QOCtwEXNOf4xx9E5bQBwFbAsyR5J5tO5APDHVbUOeDLJkc2nAk4Cruzbi5AkaSc3iGsCAC5vrgl4Djitqh5L8vUkh9M5pH838F6AqrotySXA7XROG5xWVRub/ZwKnA/sCVzT3CRJ0lYYSAioqqMmqL1rM+uvAFZMUF8NLNi+s5MkqR38xkBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQYSApJ8KMmaJLcl+XBT2zfJd5P8rLnfp2v9jydZm+TOJMd21RclubUZOydJBvByJEnaKfU9BCRZAPw5cARwGPDHSQ4GPgZcW1UHA9c2j0lyCLAMOBRYAnwhybRmd+cCy4GDm9uSPr4USZJ2aoM4EvBa4EdV9XRVbQC+DxwHLAUuaNa5AHhLs7wUuLiqnq2qu4C1wBFJ9gdmVdX1VVXA17q2kSRJWzB9AM+5BliRZDbwa+DNwGpgTlWtA6iqdUle1aw/F/hR1/ajTe25Znl8/UWSLKdzxIA5c+YwMjIy4cTWr18/6Zh6w573nz0fDPvef/Z8y/oeAqrqjiSfBb4LrAduATZsZpOJzvPXZuoTPedKYCXA4sWLa3h4eMInGhkZYbIx9YY97z97Phj2vf/s+ZYN5MLAqjqvql5fVUcDvwR+BjzYHOKnuX+oWX0UOKBr83nAA0193gR1SZK0FQb16YBXNfcHAm8FLgKuAk5uVjkZuLJZvgpYlmSPJPPpXAD44+bUwZNJjmw+FXBS1zaSJGkLBnFNAMDlzTUBzwGnVdVjST4DXJLk3cC9wPEAVXVbkkuA2+mcNjitqjY2+zkVOB/YE7imuUmSpK0wkBBQVUdNUHsUOGaS9VcAKyaorwYWbPcJSpLUAn5joCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRShgBJklrKECBJUksZAiRJailDgCRJLWUIkCSppQwBkiS1lCFAkqSWMgRIktRSAwkBSf4yyW1J1iS5KMmMJJ9Mcn+Sm5vbm7vW/3iStUnuTHJsV31RklubsXOSZBCvR5KknVHfQ0CSucAHgcVVtQCYBixrhs+uqsOb2z826x/SjB8KLAG+kGRas/65wHLg4Oa2pH+vRJKkndugTgdMB/ZMMh2YCTywmXWXAhdX1bNVdRewFjgiyf7ArKq6vqoK+Brwlh7PW5KkXUbfQ0BV3Q+cBdwLrAMer6p/bobfn+SnSb6SZJ+mNhe4r2sXo01tbrM8vi5JkrbC9H4/YfPLfSkwH/gVcGmSd9I5tP8poJr7vwX+DJjoPH9tpj7Rcy6nc9qAOXPmMDIyMuHc1q9fP+mYesOe9589Hwz73n/2fMv6HgKANwF3VdXDAEmuAH6vqi4cWyHJl4BvNw9HgQO6tp9H5/TBaLM8vv4iVbUSWAmwePHiGh4ennBiIyMjTDam3rDn/WfPB8O+958937JBXBNwL3BkkpnN1fzHAHc05/jHHAesaZavApYl2SPJfDoXAP64qtYBTyY5stnPScCV/XsZkiTt3Pp+JKCqbkhyGXATsAH4CZ136V9OcjidQ/p3A+9t1r8tySXA7c36p1XVxmZ3pwLnA3sC1zQ3SZK0FQZxOoCqOgM4Y1z5XZtZfwWwYoL6amDB9p2dJEnt4DcGSpLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS1lCJAkqaUMAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS1lCJAkqaUMAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS1lCJAkqaUMAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS01kBCQ5C+T3JZkTZKLksxIsm+S7yb5WXO/T9f6H0+yNsmdSY7tqi9Kcmszdk6SDOL1SJK0M+p7CEgyF/ggsLiqFgDTgGXAx4Brq+pg4NrmMUkOacYPBZYAX0gyrdnducBy4ODmtqSPL0WSpJ3aoE4HTAf2TDIdmAk8ACwFLmjGLwDe0iwvBS6uqmer6i5gLXBEkv2BWVV1fVUV8LWubSRJ0hb0PQRU1f3AWcC9wDrg8ar6Z2BOVa1r1lkHvKrZZC5wX9cuRpva3GZ5fF2SJG2F6f1+wuZc/1JgPvAr4NIk79zcJhPUajP1iZ5zOZ3TBsyZM4eRkZEJn2j9+vWTjqk37Hn/2fPBsO/9Z8+3rO8hAHgTcFdVPQyQ5Arg94AHk+xfVeuaQ/0PNeuPAgd0bT+PzumD0WZ5fP1FqmolsBJg8eLFNTw8POHERkZGmGxMvWHP+8+eD4Z97z97vmWDuCbgXuDIJDObq/mPAe4ArgJObtY5GbiyWb4KWJZkjyTz6VwA+OPmlMGTSY5s9nNS1zaSJGkL+n4koKpuSHIZcBOwAfgJnXfpLwcuSfJuOkHh+Gb925JcAtzerH9aVW1sdncqcD6wJ3BNc5MkSVthEKcDqKozgDPGlZ+lc1RgovVXACsmqK8GFmz3CUqS1AJ+Y6AkSS1lCJAkqaUMAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSdoBrFoFQ0Ow226d+1Wrev+cA/myIEmS9BurVsHy5fD0053H99zTeQxw4om9e16PBEiSNGCf+MRvAsCYp5/u1HvJECBJ0oDde+/U6tuLIUCSpAE78MCp1bcXQ4AkSQO2YgXMnPnC2syZnXovGQIkSRqwE0+ElSvhoIMg6dyvXNnbiwLBTwdIkrRDOPHE3v/SH88jAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWopQ4AkSS1lCJAkqaUMAZIktZQhQJKklkpVDXoOfZXkYeCeSYb3Ax7p43RkzwfBng+Gfe8/e95xUFW9cqKB1oWAzUmyuqoWD3oebWLP+8+eD4Z97z97vmWeDpAkqaUMAZIktZQh4IVWDnoCLWTP+8+eD4Z97z97vgVeEyBJUkt5JECSpJZqVQhIckCS7yW5I8ltST7U1PdN8t0kP2vu9+na5uNJ1ia5M8mxg5v9zivJtCQ/SfLt5rH97rEkr0hyWZJ/bf57f4N9760kf9n8XFmT5KIkM+z59pXkK0keSrKmqzblHidZlOTWZuycJOn3a9lRtCoEABuA06vqtcCRwGlJDgE+BlxbVQcD1zaPacaWAYcCS4AvJJk2kJnv3D4E3NH12H733ueA71TV7wCH0em/fe+RJHOBDwKLq2oBMI1OT+359nU+nX5125YenwssBw5ubuP32RqtCgFVta6qbmqWn6Tzg3EusBS4oFntAuAtzfJS4OKqeraq7gLWAkf0ddI7uSTzgP8AfLmrbL97KMks4GjgPICq+v+q6lfY916bDuyZZDowE3gAe75dVdUPgF+OK0+px0n2B2ZV1fXVuSjua13btE6rQkC3JEPA64AbgDlVtQ46QQF4VbPaXOC+rs1Gm5q23n8B/hrY1FWz3731auBh4KvNaZgvJ3kZ9r1nqup+4CzgXmAd8HhV/TP2vB+m2uO5zfL4eiu1MgQkeTlwOfDhqnpic6tOUPPjFFspyR8DD1XVjVu7yQQ1+z1104HXA+dW1euAp2gOkU7Cvr9EzXnopcB84LeAlyV55+Y2maBmz7evyXps77u0LgQk2Z1OAFhVVVc05QebQ0Q09w819VHggK7N59E5xKet80bgPya5G7gY+PdJLsR+99ooMFpVNzSPL6MTCux777wJuKuqHq6q54ArgN/DnvfDVHs82iyPr7dSq0JAcwXoecAdVfV/dQ1dBZzcLJ8MXNlVX5ZkjyTz6VxA8uN+zXdnV1Ufr6p5VTVE5wKd66rqndjvnqqq/w7cl+R/bErHALdj33vpXuDIJDObnzPH0LnmyJ733pR63JwyeDLJkc2/1Uld27TO9EFPoM/eCLwLuDXJzU3tfwU+A1yS5N10/mc+HqCqbktyCZ0foBuA06pqY99nveux3733AWBVkn8D/AL4Uzqh3773QFXdkOQy4CY6PfwJnW+rezn2fLtJchEwDOyXZBQ4g237eXIqnU8a7Alc09xayW8MlCSppVp1OkCSJP2GIUCSpJYyBEiS1FKGAEmSWsoQIElSSxkCJE0qyfoe7PPMJG/a3vuVNHV+RFDSpJKsr6qXD3oeknrDIwGSpiTJSJLFzfJ+zddCk+SUJN9K8g9J7kry/iQfaf6I0Y+S7Nusd36StzfLn0lye5KfJjmrqb0yyeVJ/qW5vbGpvzzJV5u/A//TJG8bSAOkXUjbvjFQUm8toPPXOWfQ+dOt/0tVvS7J2XS+nvW/jK3YhILjgN+pqkryimboc8DZVfXfkhwI/BPwWuB/p/PX+RY22+/Tn5ck7boMAZK2p+9V1ZN0vpv9ceAfmvqtwL8bt+4TwDPAl5NcDXy7qb8JOKTzte4AzEqyV1NfNlasqsd68xKk9jAESJqqDfzmVOKMcWPPdi1v6nq8iXE/b6pqQ5Ij6PyxnWXA+4F/3+z7DVX16+71mz/24kVM0nbkNQGSpupuYFGz/PZt3UmSlwN7V9U/Ah8GDm+G/plOIBhbb7K6pwOkl8gQIGlzZiYZ7bp9BDgLODXJD4H9XsK+9wK+neSnwPeBv2zqHwQWNxf/3Q68r6l/GtgnyZoktwB/8BKeWxJ+RFCSpNbySIAkSS1lCJAkqaUMAZIktZQhQJKkljIESJLUUoYASZJayhAgSVJLGQIkSWqp/x9xWb0TkDbFLAAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_ vs Lumisec_BB\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "99e935c7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [18441.330842994266, 16140.353268559671, 12187.337491223963]\n",
      "lumi [52315.55170786302, 45028.946744688306, 33276.63087550684]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = float(open(\"N_2Iee1.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = float(open(\"N_1Iee1.txt\").read())   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = float(open(\"N_2Iee2.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = float(open(\"N_1Iee2.txt\").read())    # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = float(open(\"N_2Iee3.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = float(open(\"N_1Iee3.txt\").read())  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 =  float(open(\"eN_2Iee1.txt\").read())  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 =  float(open(\"eN_1Iee1.txt\").read())  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 =  float(open(\"eN_2Iee2.txt\").read()) # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 =  float(open(\"eN_1Iee2.txt\").read())  # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 =  float(open(\"eN_2Iee3.txt\").read()) # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 =  float(open(\"eN_1Iee3.txt\").read()) # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints,N_values , marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_ID vs Lumisec_EE\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c3749b06",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [14118.654770683628, 11370.420889094221, 9367.676159912931]\n",
      "lumi [39231.209652052145, 30526.777599325418, 25281.110636684116]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = float(open(\"N_2Ibb9.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = float(open(\"N_1Ibb9.txt\").read())   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = float(open(\"N_2Ibb10.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = float(open(\"N_1Ibb10.txt\").read())    # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = float(open(\"N_2Ibb11.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = float(open(\"N_1Ibb11.txt\").read())  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 =  float(open(\"eN_2Ibb9.txt\").read())  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 =  float(open(\"eN_1Ibb9.txt\").read())  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 =  float(open(\"eN_2Ibb10.txt\").read()) # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 =  float(open(\"eN_1Ibb10.txt\").read())  # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 =  float(open(\"eN_2Ibb11.txt\").read()) # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 =  float(open(\"eN_1Ibb11.txt\").read()) # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints,N_values , marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_ID vs Lumisec_BB\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "983f8c52",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [18138.173044660616, 15280.569652944374, 12273.9271003187]\n",
      "lumi [50673.8346114177, 42191.30539191176, 33022.90884598454]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = float(open(\"N_2Ibe4.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = float(open(\"N_1Ibe4.txt\").read())   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = float(open(\"N_2Ibe5.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = float(open(\"N_1Ibe5.txt\").read())    # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = float(open(\"N_2Ibe6.txt\").read())  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 = float(open(\"N_1Ibe6.txt\").read())  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 =  float(open(\"eN_2Ibe4.txt\").read())  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 =  float(open(\"eN_1Ibe4.txt\").read())  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 =  float(open(\"eN_2Ibe5.txt\").read()) # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 =  float(open(\"eN_1Ibe5.txt\").read())  # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 =  float(open(\"eN_2Ibe6.txt\").read()) # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 =  float(open(\"eN_1Ibe6.txt\").read()) # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_results.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2idpass_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.22858255458717672*2.018*0.8742*efficiency_bin1)\n",
    "l_bin2 = N_bin2/(0.22858255458717672*2.018*efficiency_bin2*0.8801)\n",
    "l_bin3 = N_bin3/(0.22858255458717672*2.018*efficiency_bin3*0.8949)\n",
    "\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi\", l_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.scatter(lumisec_midpoints, N_values, marker='o', color='blue', label='N vs Lumisec')\n",
    "plt.scatter(lumisec_midpoints,N_values , marker='o', color='blue')\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"N\")\n",
    "plt.title(\"N_ID vs Lumisec_BE\")\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "9f057fe1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "lumi_bril [114618.486, 97972.294, 81904.476]\n",
      "lumi_EE [84919.03121689166, 74214.58391348073, 62060.65001473216]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "import math\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionEE_hlt.root\"\n",
    "\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 10392.20   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 3370.69    # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 =  9135.45   # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  2977.35  # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  7624.64  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  2529.20  # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "signal_error_2idpass_bin1 = 159.01  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 98.26   # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 142.85  # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 90.42   # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 121.28  # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 71.29   # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_EE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 41, 81\n",
    "x_bin_start3, x_bin_end3 = 81, 119\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.106*2.073*efficiency_bin1*0.8742)\n",
    "l_bin2 = N_bin2/(0.106*2.073*efficiency_bin2*0.8811)\n",
    "l_bin3 = N_bin3/(0.106*2.073*efficiency_bin3*0.8860)\n",
    "lbril_values = [114618.486  , 97972.294 , 81904.476]\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "luminosity_errors = [(0.00264+(4.44*math.pow(10,-6))+0.0235+(4.2162*math.pow(10,-7))) , (0.00247+(4.44*math.pow(10,-6))+0.0235+(5.5358*math.pow(10,-7))) , (0.001366+(4.44*math.pow(10,-6))+0.0235+(9.6669*math.pow(10,-7)))]\n",
    "\n",
    "print(\"lumi_bril\",lbril_values)\n",
    "print(\"lumi_EE\", l_values)\n",
    "rat = [lbril_values[0]/l_values[0], lbril_values[1]/l_values[1] , lbril_values[2]/l_values[2]]\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.errorbar(lumisec_midpoints, l_values, xerr=luminosity_errors, fmt='o', color='black', capsize=5,label=\"lumi_EE\")\n",
    "# plt.errorbar(lumisec_midpoints,lbril_values , xerr=luminosity_errors, fmt='o', color='red', capsize=5,label=\"lumi_bril\")\n",
    "plt.errorbar(lumisec_midpoints, rat , fmt='o', color='red', capsize=5,label=\"lumi_bril/lumi_EE\")\n",
    "\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"lumi_bril/lumi_EE\")\n",
    "plt.grid()\n",
    "plt.legend()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "c72ae13d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "lumi_bril [114618.486, 97972.294, 81904.476]\n",
      "lumi_BE [82368.65889857369, 70811.38566012947, 65611.04603863167]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAfkAAAFzCAYAAAA9nXBaAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/H5lhTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAg/ElEQVR4nO3dfZBddZ3n8feXJBBCgmIyZkYS6ICUIE8BGhYGhukILnFAgcFVMMIg42a0BnFwpkaRHakZh1KqmAcW12FTEYNlhpQTwVWGB90wDcWjS4CFQHAWIQktOEAQoSVBIt/9496QS7jdfW/6nr7Jr9+vqq6+5/zOOffb3yT9yXm8kZlIkqTy7NTtAiRJUjUMeUmSCmXIS5JUKENekqRCGfKSJBXKkJckqVATu11AJ82YMSN7enqajv3qV79it912G9uCBNj7brL33WPvu2e89X7lypXPZ+ZvNRsrKuR7enq47777mo719/fT19c3tgUJsPfdZO+7x953z3jrfUSsHWrMw/WSJBXKkJckqVCGvCRJhSrqnLwkjVevvfYaAwMDbNy4sduldN3b3vY2Vq9e3e0yOm7y5MnMmjWLSZMmtbyOIS9JBRgYGGDatGn09PQQEd0up6tefvllpk2b1u0yOiozWb9+PQMDA8yZM6fl9TxcL0kF2LhxI9OnTx/3AV+qiGD69OltH6kx5CWpEAZ82bblz9eQlySpUIa8JI1HS5dCTw/stFPt+9Klo97k1KlTR70NgKeffpoPf/jDQ44vWbKE888/v6Vt/cEf/AEvvvgi8Nb65s+fz89+9jP6+vqGfJBauxrfr5kJEyYwd+5cDj30UA4//HDuuusuANasWcOuu+7K3Llz3/j61re+Nep6vPBuKEuXwsUXw7p1sNdecOmlsGBBt6uSpNFbuhQWLoRXXqlNr11bm4bt4vfcu971LpYvXz6qbWQmmcmNN97YdHzDhg288MIL7LnnnqN6n60N9X6b7brrrjz44IMA3HLLLVx00UXcdtttAOy7775vjHWKe/LNbP4HsHYtZG75B9CB/+lKUtddfPGWgN/slVdq8zugv7+fU0455Y3p888/nyVLlgC1x49/8Ytf5JhjjqG3t5f777+fk046iX333ZerrroKqO3VHnTQQcO+x1NPPcX8+fN5z3vew1//9V+/sd4BBxzAhRdeyOGHH85TTz1FT08Pzz//fNMamz36tnFvf/ny5Zx77rkAnHvuuXz6059m3rx57LPPPtx2222cd955HHDAAW8ss/nna/Z+zbz00kvsscceLS27rdyTb2a4fwDbwf9yJWlU1q1rb36HzZ49m7vvvpsLL7yQc889lzvvvJONGzdy4IEH8qlPfaqlbfz4xz9m1apVTJkyhSOPPJKTTz6ZGTNm8JOf/ISvfe1rLF68eNj1b7rpJk477bS26v7FL37Brbfeyve//30++MEPcuedd7J48WKOPPJIHnzwQebOnTviNjZs2MDcuXPZuHEjzzzzDLfeeusbYz/96U/ftI0rr7yS3/u932urxq0Z8s10+R+AJFVqr71qRyibzR8DH/rQhwA4+OCDGRwcZNq0aUybNo3JkycPez670fvf/36mT58OwB/+4R9yxx13cNppp7H33ntz1FFHjbj+nXfeyeWXX95W3R/84AeJCA4++GBmzpzJwQcfDMCBBx7ImjVrWgr5xsP1d999N+eccw6rVq0CPFw/dob6iz5G/wAkqVKXXgpTprx53pQptfkdMHHiRF5//fU3pre+t3uXXXYBYKeddnrj9ebpTZs2tfQeW99Otnm6lY+YfeKJJ5g9ezY777zzsNutou5GxxxzDM8//zzPPfdc2+u2ypBvpuJ/AJLUVQsWwKJFsPfeEFH7vmhRx05H7r333jz66KO8+uqr/PKXv2TFihUd2W6jH/3oR7zwwgts2LCB733vexx77LEtr3vTTTcxf/78pmMzZ85k9erVvP7661x//fWdKrepxx57jN/85jdvHJGogofrm9n8F92r6yWVasGCyn6nzZ49m4985CMccsgh7Lfffhx22GEdf4/jjjuOs88+m8cff5yPfexj9Pb2smbNmpbWvfnmm7nyyiubjn31q1/llFNOYfbs2Rx00EEMDg52sOot5+ShdgfANddcw4QJE4C3npM/77zzuOCCC0b1fpGZo9rA9qS3tzeHutdxqCspVT173z32vnvGuverV6/mgAMOGLP3254N9+z6V199lWOPPbZj98WPtWZ/zhGxMjN7my3v4XpJ0rixyy677LABvy08XC9J2i7dcsstfP7zn3/TvDlz5lR+rny01q9fzwknnPCW+StWrKj0/Hszhrwkabt00kkncdJJJ3W7jLZNnz6947fCbSsP10tSIUq6xkpvtS1/voa8JBVg8uTJ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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBE_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 =  10692.75 # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 =  3561.70  # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 9046.66   # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  3153.22   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  7807.83  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  2649.42   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 149.67# Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 84.11 # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 133.06 # Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 72.53 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 116.85 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 63.34 # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BE\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 41, 81\n",
    "x_bin_start3, x_bin_end3 = 81, 119\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.112*2.073*efficiency_bin1*0.8876)\n",
    "l_bin2 = N_bin2/(0.112*2.073*efficiency_bin2*0.8910)\n",
    "l_bin3 = N_bin3/(0.112*2.073*efficiency_bin3*0.8202)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "lbril_values = [114618.486  , 97972.294 , 81904.476]\n",
    "luminosity_errors = [(0.00156+(4.6506*math.pow(10,-6))+0.0235+(4.3467*math.pow(10,-7))) , (0.00161+(4.6506*math.pow(10,-6))+0.0235+(5.9759*math.pow(10,-7))) , (0.0019+(4.6506*math.pow(10,-6))+0.0235+(9.9927*math.pow(10,-7)))]\n",
    "print(\"lumi_bril\", lbril_values)\n",
    "print(\"lumi_BE\", l_values)\n",
    "rat = [lbril_values[0]/l_values[0], lbril_values[1]/l_values[1] , lbril_values[2]/l_values[2]]\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "# plt.errorbar(lumisec_midpoints, l_values, xerr=luminosity_errors, fmt='o', color='black',  capsize=5,label=\"lumi_BE\")\n",
    "# plt.errorbar(lumisec_midpoints, lbril_values , xerr=luminosity_errors, fmt='o', color='red',  capsize=5,label=\"lumi_bril\")\n",
    "plt.errorbar(lumisec_midpoints, rat , fmt='o', color='red',  capsize=5,label=\"lumi_bril/lumi_BE\")\n",
    "\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"lumi_bril/lumi_BE\")\n",
    "plt.legend()\n",
    "plt.grid()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "4e88ccb8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "lumi_BB [99658.0222043201, 94230.24555373803, 78279.57945273764]\n",
      "lumi_bril [114618.486, 97972.294, 81904.476]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAfkAAAFzCAYAAAA9nXBaAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/H5lhTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAe0UlEQVR4nO3de5CddZ3n8fc3F+hEgmDiRk0CHSlKwh2mURBmthVdAkTQGdcCo4huVY+OCDpa4yA7S83UMDJV7AxedmRTCME1g6V4WXQBdcEjBQIKiBAI1IJC0gITLgqEJAwx3/3jnKRPwunknPR5+nR+/X5VdZ3z/H7PeZ5v/zrdnzz3yEwkSVJ5pvS6AEmSVA1DXpKkQhnykiQVypCXJKlQhrwkSYUy5CVJKtS0XhfQTXPmzMn+/v6WfS+++CKvetWrxrcgAY59Lzn2vePY985kG/u77rrr6cx8bau+okK+v7+fO++8s2VfrVZjcHBwfAsS4Nj3kmPfO45970y2sY+Ix0brc3e9JEmFMuQlSSqUIS9JUqGKOiYvSZPRyy+/zPDwMBs3bux1KRPCq1/9alatWtXrMrqur6+P+fPnM3369LY/Y8hL0m5ueHiYWbNm0d/fT0T0upyee+GFF5g1a1avy+iqzOSZZ55heHiYhQsXtv05d9dL0m5u48aNzJ4924AvWEQwe/bsjvfWGPKSVAADvny78jM25CVJKpQhL0mTzYoV0N8PU6bUX1esGPMi99prrzEvA+Dxxx/nve9976j9y5cv55xzzmlrWaeccgq///3vgVfWt3jxYn77298yODg46k3UOtW8vlamTp3KkUceyRFHHMHRRx/Nz372MwAeffRRZsyYsbXvrW99Kw899FBXajLkR1PBL4Ek9dyKFTA0BI89Bpn116GhCfM37g1veAPXXHPNmJaRmWzevJnrrruOffbZ5xX9GzZs4Nlnn2XevHljWs/2RlvfFjNmzOCee+7hV7/6FZ///Oc5//zzt/YdcMABW/s+9KEP8Q//8A9dqcmQb2WC/xJI0i674AJYv37btvXr6+1dUKvVWLJkydbpc845h+XLlwP1W49/7nOf47jjjmNgYIC7776bk046iQMOOIDLLrsMqG/VHnrooTtcx5o1a1i8eDFvetOb+Nu//dutn1u0aBF/8Rd/wR//8R+zZs0a+vv7efrpp1vW2Oq2t81b+9dccw1nn302AGeffTYf+9jHeNvb3sYb3/hGfvrTn/KRj3yERYsWbZ1ny/fXan2tPP/88+y7774d93XKS+ha2dEvwdKlvalJkrph9erO2rtswYIF3HbbbXzqU5/i7LPP5tZbb2Xjxo0ccsghfPSjH21rGT//+c9ZuXIlM2fO5JhjjuHUU09lzpw5PPTQQ1x55ZX84z/+4w4vobv++ut597vf3VHdv/vd77jpppu49tprede73sWtt97K5ZdfzjHHHMM999zDkUceudNlbNiwgSOPPJKNGzfyxBNPcNNNN23te+SRRzjyyCN54YUXWL9+PXfccUdH9Y3GLflWevxLIEmV2W+/ztq77LTTTgPgsMMO4y1veQuzZs3ita99LX19fTs8nt3sne98J7Nnz2bGjBn86Z/+KbfccgsA+++/P8cee+xOP3/rrbdywgkndFT3u971LiKCww47jLlz53LYYYcxZcoUDjnkEB599NG2lrFld/2DDz7IDTfcwFlnnUVmAiO76x955BEuvfRShoaGOqpvNIZ8Kz3+JZCkylx0EcycuW3bzJn19i6YNm0amzdv3jq9/XXde+65JwBTpkzZ+n7L9KZNm9pax/aXkm2Zbufxsr/+9a9ZsGABe+yxxw6XW0XdzY477jiefvppnnrqqVf0nXbaadx8880dL7MVQ76Vin8JJKlnli6FZctg//0hov66bFnXDkXuv//+PPDAA7z00ks899xz3HjjjV1ZbrMf//jHPPvss2zYsIHvfe97HH/88W1/9vrrr2fx4sUt++bOncuqVavYvHkz3/3ud7tVbksPPvggf/jDH5g9e/Yr+m655RYOOOCArqzHY/KtbPnHfsEF9V30++1XD3iPx0sqwdKllf09W7BgAe973/s4/PDDOfDAAznqqKO6vo4TTjiBD37wgzz88MO8//3vZ2BgoO1d5jfccANf+tKXWvZdfPHFLFmyhAULFnDooYeybt26LlY9ckwe6lcAXHXVVUydOhUYOSafmeyxxx5cfvnlXVlnbDkeUIKBgYEc7XrH0c6mVPUc+95x7HtnPMd+1apVLFq0aFzWtTsY7d71L730Escff3zXrovvhVY/64i4KzMHWs3v7npJ0qSw55577tYBvyvcXS9JmnB++MMf8tnPfnabtoULF1Z+rHysnnnmGU488cRXtN94440tj79XzZCXJE04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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "\n",
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7403.13  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 =  2404.55 # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 =  6098.08  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  2009.72   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 41, 81\n",
    "x_bin_start3, x_bin_end3 = 81, 119\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.073*2.073*efficiency_bin1*0.8925)\n",
    "l_bin2 = N_bin2/(0.073*2.073*efficiency_bin2*0.8154)\n",
    "l_bin3 = N_bin3/(0.073*2.073*efficiency_bin3*0.8135)\n",
    "lbril_values = [114618.486  , 97972.294 , 81904.476]\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "rat = [lbril_values[0]/l_values[0], lbril_values[1]/l_values[1] , lbril_values[2]/l_values[2]]\n",
    "luminosity_errors = [(0.00255+(5.4*math.pow(10,-6))+0.0235+(7.5935*math.pow(10,-7))) , (0.00257+(5.4*math.pow(10,-6))+0.0235+(1.3403*math.pow(10,-6))) , (0.0028+(5.4*math.pow(10,-6))+0.0235+(1.7005*math.pow(10,-6)))]\n",
    "print(\"lumi_BB\" , l_values)\n",
    "print(\"lumi_bril\" , lbril_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints, rat , fmt='o', color='red',  capsize=5,label=\"lumi_bril/lumi_BB\")\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"lumi_bril/lumi_BB\")\n",
    "plt.legend()\n",
    "plt.grid()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "2fb5a68c",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [11684.14212370706, 10194.79585686655, 7801.4145289387825]\n",
      "lumi_bb [24708.215179851213, 21969.404332607905, 16828.162021434615]\n",
      "bril [116086.333, 100081.51, 93398.989]\n"
     ]
    },
    {
     "data": {
      "image/png": "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W1tmZh5//PH5wgsvZGbmQw89lFOnTs3MzI9//OM5e/bsDT+j4/Y6709mbrQPmZnnn39+3nTTTZmZOXr06Lz++uszM/OLX/xijh8/Pt98881cvnx57rfffpmZuWjRojz00EMzM/Omm27KMWPG5Ouvv56rV6/OAw88MJcsWZJ//OMfc9SoUbl8+fJcu3ZtTp06NX/yk5/k/Pnz84QTTtjws1977bUN+3r77bdv6MPLL7+cmZmtra35/ve/P995553MzDzmmGPyd7/73Xv2ras/L8D87OLfxJrflGl7d+ml0PnI0KpVlXp9fW36JElvv/12j+o9MWHCBF588UXmzJnDX/zFX2y07Je//CV33XUX11xzDVC5gmPJkiUccMABXHDBBTzxxBMMGDCAF154AYDJkydzzjnnsHbtWk477TQmTpzY7c8/44wzGDBgAK2trfz617/mjDPevVCuff/+8z//kzvuuAOAGTNmcMUVV2zVPn/iE58AYPz48bS2tjJ06FCGDh3KoEGDeP3119+z/rRp09hjjz0AOOSQQ1i8eDGvvvoqU6ZMYb/9Ks9xqq+v58EHH+Syyy7jD3/4AxdeeCEnn3wyJ554Ymlfdt11V44//njuvvtuDj74YNauXcv48eO3av8MC31syZKe1SWprzU3N1NXV8fixe99ZtDo0aNpbm7e6ssvP/GJT/DlL3+Z5uZmXn311Q31zOSOO+7ggx/84EbrX3nllQwbNownn3yS9evXM2jQIAA++tGP8uCDD/LTn/6UM888k7//+7/nrLPO2qh/nW9C1f4EyfXr17PnnnvyxBNPdNnHnuzjwIEDWb9+/SZ/5i677ALATjvttOFz+/eu5k50XGfAgAG0tbWRm3gK9F577cWTTz7JL37xC773ve8xd+5cbryx/G4An/nMZ/jHf/xHDjroID796U93v4PdcM5CHzvwwJ7VJakaZs2axZAhQzaqDRkyhFmz3nN7my1yzjnncPnll7/nN9qTTjqJ7373uxv+YXz88ccBeOONNxg+fDg77bQTt9xyC+vWVe7Dt3jxYvbff3/OO+88zj33XB577DGg8vyeBQsWsH79en7yk5902Yfdd9+dMWPGcPvttwOVoPLkk08CcOyxx3LrrbcCMHfu3G73Z/To0Tz77LO8/fbbvPHGG9x33309HZJufehDH+JXv/oVr7zyCuvWrWPOnDkcd9xxvPLKK6xfv55PfvKTfP3rX98wBh0NHTqUlStXbrStl156iX/7t3/baM7IljIs9LFZs6DT/48MGVKpS1Kt1NfX09jYyOjRo4kIRo8eTWNjI/W9dH505MiRfOELX3hP/bLLLmPt2rVMmDCBcePGcdlllwHw+c9/ntmzZ3P00UfzwgsvbDg60NzczMSJEzn88MO54447Nmzzm9/8JqeccgrHH388w4cP32Q/mpqauOGGGzjssMM49NBDN0yo/M53vsP3vvc9Jk+ezJtvvtnt/owaNYpPfepTTJgwgfr6eg4//PAej0l3hg8fztVXX83UqVM57LDDOOKIIzj11FP54x//yJQpU5g4cSJnn302V1999XvaNjQ08LGPfYypU6duqH3qU5/i2GOPZa+99nrP+j3W1UQGX703wTGzMplx9OjMiMq7kxu3jJPtqs8xr75qTHDcHJu73vagfdLk9ubkk0/Oe++9d5PLezLB0SMLVVBfDy++COvXV96d2CipVjZ3It/WTvhT7bz++uv8+Z//OYMHD2batGm9sk0nOErSDsTbPW//9txzzw1Xk/QWjyxIkqRShgVJklTKsCBJkkoZFiRJUinDgiSp1wwYMICJEyduuE9A+wOhuvLhD38Y2PghSz3V/jAl9S3DgiTtoPriibiDBw/miSee4Mknn+Tqq6/mkksuec867XdnLAsS6l8MC5K0A2pqgoYGWLy48jzcxYsr33sjMLR78803N9w9sLm5malTp/I3f/M3G24B3fEx0+3WrVvHl7/8ZcaPH8+ECRP47ne/C8BVV13F5MmTGTduHA0NDV0+R+HRRx/lwx/+MIcddhhHHXXURrc/1tbxPguStAPqqyfirl69mokTJ7JmzRqWLVvG/fffv2HZI488wtNPP82YMWM22b6xsZFFixbx+OOPM3DgQFasWAHABRdcwOWXXw7AmWeeyd13383HP/7xDe3eeecd/uqv/orbbrttwy2cBw8evOU7oo14ZEGSdkB99UTc9tMQzz33HD//+c8566yzNhwFOOqoo0qDAsC9997LZz/7WQYOrPwuu/feewPwwAMP8KEPfYjx48dz//3388wzz2zU7vnnn2f48OFMnjwZqDxEqn0b2nqOpCTtgA48sHLqoat6bznmmGN45ZVXePnll4F3Hx1dJjPf8+joNWvW8PnPf5758+czatQo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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "import math\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.31*2.018*efficiency_bin1*0.8708)\n",
    "l_bin2 = N_bin2/(0.31*2.018*efficiency_bin2*0.8625)\n",
    "l_bin3 = N_bin3/(0.31*2.018*efficiency_bin3*0.8629)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [(33508.88574846459+42953.99898400971+40181.36958173203),(29794.554336871133+37890.61341001629+27566.953653143104),(22822.083846539463+30042.71043743979+27566.953653143104)]\n",
    "l_evalues = [(0.02605540995+0.02506508527+0.02614507222),(0.0260759909+0.02511524819+0.02597520418),(0.0263063511+0.025405649869999998+0.02487161729)]\n",
    "luminosity_errors = [(0.00255+(0.000001585)+0.000141+(7.5935*math.pow(10,-7))) , (0.00257+(0.000001585)+0.000141+(1.3403*math.pow(10,-6))) , (0.0028+(0.000001585)+0.000141+(1.7005*math.pow(10,-6)))]\n",
    "lbril_values = [116086.333 , 100081.51 , 93398.989]\n",
    "lbb_values = [l_bin1,l_bin2,l_bin3]\n",
    "print(\"N pro\", N_values)\n",
    "print (\"lumi_bb\",lbb_values)\n",
    "print(\"bril\",lbril_values)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints,lbb_values , xerr=l_evalues, fmt='o', color='black',label=\"Measured luminosity\"  ,capsize=5)\n",
    "plt.errorbar(lumisec_midpoints, lbril_values, fmt='o', color='blue', label=\"Brilcalc\", capsize=5)\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"$L_{total}$\")\n",
    "plt.legend()\n",
    "plt.grid()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13790cc8",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "4fb2322a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "N pro [11684.14212370706, 10194.79585686655, 7801.4145289387825]\n",
      "lumi_hltBB [24708.215179851213, 21969.404332607905, 16828.162021434615]\n",
      "errorlumi_hltBB [0.026051969350000002, 0.0260725503, 0.0263029105]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ROOT file with projections\n",
    "root_file_path = \"mass_regionBB_hlt.root\"\n",
    "\n",
    "# Replace these with fit results for each histogram\n",
    "# Signal yields for 2idpass and 1idpass (bins 1, 2, 3)\n",
    "signal_2idpass_bin1 = 8804.51   # Replace with fit result for h_mass_2idpass_EE_hist1\n",
    "signal_1idpass_bin1 = 2676.26   # Replace with fit result for h_mass_1idpass_EE_hist1\n",
    "signal_2idpass_bin2 = 7540.76  # Replace with fit result for h_mass_2idpass_EE_hist2\n",
    "signal_1idpass_bin2 = 2454.33   # Replace with fit result for h_mass_1idpass_EE_hist2\n",
    "signal_2idpass_bin3 = 5753.87  # Replace with fit result for h_mass_2idpass_EE_hist3\n",
    "signal_1idpass_bin3 =  1892.01   # Replace with fit result for h_mass_1idpass_EE_hist3\n",
    "\n",
    "# Signal errors for 2idpass and 1idpass (standard errors from the fit)\n",
    "# Replace these with the actual error values obtained from your fits\n",
    "signal_error_2idpass_bin1 = 130.78  # Replace with error for signal_2idpass_bin1\n",
    "signal_error_1idpass_bin1 = 68.76  # Replace with error for signal_1idpass_bin1\n",
    "signal_error_2idpass_bin2 = 115.17# Replace with error for signal_2idpass_bin2\n",
    "signal_error_1idpass_bin2 = 58.21 # Replace with error for signal_1idpass_bin2\n",
    "signal_error_2idpass_bin3 = 99.63 # Replace with error for signal_2idpass_bin3\n",
    "signal_error_1idpass_bin3 = 52.09  # Replace with error for signal_1idpass_bin3\n",
    "\n",
    "# Calculate efficiencies for each bin\n",
    "efficiency_bin1 = (2 * signal_2idpass_bin1) / (2 * signal_2idpass_bin1 + signal_1idpass_bin1)\n",
    "efficiency_bin2 = (2 * signal_2idpass_bin2) / (2 * signal_2idpass_bin2 + signal_1idpass_bin2)\n",
    "efficiency_bin3 = (2 * signal_2idpass_bin3) / (2 * signal_2idpass_bin3 + signal_1idpass_bin3)\n",
    "\n",
    "# Calculate errors on the efficiencies using error propagation\n",
    "def efficiency_error(N2, N1, err_N2, err_N1):\n",
    "    dE_dN2 = 2 / (2 * N2 + N1)\n",
    "    dE_dN1 = -2 * N2 / (2 * N2 + N1) ** 2\n",
    "    return np.sqrt((dE_dN2 * err_N2) ** 2 + (dE_dN1 * err_N1) ** 2)\n",
    "\n",
    "efficiency_error_bin1 = efficiency_error(signal_2idpass_bin1, signal_1idpass_bin1, signal_error_2idpass_bin1, signal_error_1idpass_bin1)\n",
    "efficiency_error_bin2 = efficiency_error(signal_2idpass_bin2, signal_1idpass_bin2, signal_error_2idpass_bin2, signal_error_1idpass_bin2)\n",
    "efficiency_error_bin3 = efficiency_error(signal_2idpass_bin3, signal_1idpass_bin3, signal_error_2idpass_bin3, signal_error_1idpass_bin3)\n",
    "\n",
    "# Load edges_lumisec from the original histogram\n",
    "demo_file = \"output_resultshlt.root\"  # Your input ROOT file from part 1\n",
    "with uproot.open(demo_file) as root_file_2:\n",
    "    uproot_hist = root_file_2[\"h_mass_2hlt_BB\"]  # Example to load any histogram\n",
    "    values, edges_lumisec, edges_mass = uproot_hist.to_numpy()\n",
    "\n",
    "# Bin ranges for projections (from part 1)\n",
    "x_bin_start1, x_bin_end1 = 1, 41\n",
    "x_bin_start2, x_bin_end2 = 42, 83\n",
    "x_bin_start3, x_bin_end3 = 83, 120\n",
    "\n",
    "# Calculate midpoints of lumisec bins for each range\n",
    "lumisec_midpoint_bin1 = (edges_lumisec[x_bin_start1] + edges_lumisec[x_bin_end1]) / 2\n",
    "lumisec_midpoint_bin2 = (edges_lumisec[x_bin_start2] + edges_lumisec[x_bin_end2]) / 2\n",
    "lumisec_midpoint_bin3 = (edges_lumisec[x_bin_start3] + edges_lumisec[x_bin_end3]) / 2\n",
    "\n",
    "# Combine data for plotting\n",
    "lumisec_midpoints = [lumisec_midpoint_bin1, lumisec_midpoint_bin2, lumisec_midpoint_bin3]\n",
    "efficiencies = [efficiency_bin1, efficiency_bin2, efficiency_bin3]\n",
    "efficiency_errors = [efficiency_error_bin1, efficiency_error_bin2, efficiency_error_bin3]\n",
    "\n",
    "# Calculate N for each bin using the formula\n",
    "N_bin1 = signal_1idpass_bin1 / (2 * efficiency_bin1 * (1 - efficiency_bin1))\n",
    "N_bin2 = signal_1idpass_bin2 / (2 * efficiency_bin2 * (1 - efficiency_bin2))\n",
    "N_bin3 = signal_1idpass_bin3 / (2 * efficiency_bin3 * (1 - efficiency_bin3))\n",
    "l_bin1 = N_bin1/(0.31*2.018*efficiency_bin1*0.8708)\n",
    "l_bin2 = N_bin2/(0.31*2.018*efficiency_bin2*0.8625)\n",
    "l_bin3 = N_bin3/(0.31*2.018*efficiency_bin3*0.8629)\n",
    "# Combine N values for plotting\n",
    "N_values = [N_bin1, N_bin2, N_bin3]\n",
    "l_values = [l_bin1, l_bin2, l_bin3]\n",
    "\n",
    "luminosity_errors = [(0.00255+(1.21*math.pow(10,-6))+0.0235+(7.5935*math.pow(10,-7))) , (0.00257+(1.21*math.pow(10,-6))+0.0235+(1.3403*math.pow(10,-6))) , (0.0028+(1.21*math.pow(10,-6))+0.0235+(1.7005*math.pow(10,-6)))]\n",
    "print(\"N pro\", N_values)\n",
    "print(\"lumi_hltBB\" , l_values)\n",
    "print(\"errorlumi_hltBB\" , luminosity_errors)\n",
    "# Plot efficiencies with error bars\n",
    "plt.figure(figsize=(8, 6))\n",
    "plt.errorbar(lumisec_midpoints, l_values, xerr=luminosity_errors, fmt='o', color='black',  capsize=5)\n",
    "plt.xlabel(\"Lumisec\")\n",
    "plt.ylabel(\"L\")\n",
    "plt.grid()\n",
    "plt.show()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ead5cd83",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
